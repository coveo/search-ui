webpackJsonpCoveo__temporary([40],{197:function(t,e,o){"use strict";var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function s(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(s.prototype=o.prototype,new s)}}();Object.defineProperty(e,"__esModule",{value:!0}),o(655);var n=o(0),i=o(17),u=o(11),a=o(129),r=o(29),l=o(5),c=o(18),y=o(13),h=o(3),p=o(6),d=o(1),L=o(16),v=o(12),f=o(4),b=o(10),m=o(7),g=o(8),S=o(2),C=o(656),R=o(15);e.defaultLayout="list";var A=function(t){function e(o,s,n){var a=t.call(this,o,e.ID,n)||this;return a.element=o,a.options=s,a.options=g.ComponentOptions.initComponentOptions(o,e,s),a.currentActiveLayouts={},a.bind.onQueryState(c.MODEL_EVENTS.CHANGE_ONE,y.QUERY_STATE_ATTRIBUTES.LAYOUT,a.handleQueryStateChanged.bind(a)),a.bind.onRootElement(u.QueryEvents.querySuccess,function(t){return a.handleQuerySuccess(t)}),a.bind.onRootElement(u.QueryEvents.queryError,function(t){return a.handleQueryError(t)}),a.resultLayoutSection=d.$$(a.element).closest(".coveo-result-layout-section"),a.bind.oneRootElement(i.InitializationEvents.afterComponentsInitialization,function(){return a.populate()}),a.bind.oneRootElement(i.InitializationEvents.afterInitialization,function(){return a.handleQueryStateChanged()}),C.ResponsiveResultLayout.init(a.root,a,{}),a}return s(e,t),Object.defineProperty(e.prototype,"activeLayouts",{get:function(){return this.currentActiveLayouts},enumerable:!0,configurable:!0}),e.prototype.changeLayout=function(t){if(l.Assert.check(this.isLayoutDisplayedByButton(t),"Layout not available or invalid"),t!==this.currentLayout||""===this.getModelValue()){this.setModelValue(t);var e=this.queryController.getLastResults();this.setLayout(t,e),e?this.usageAnalytics.logCustomEvent(b.analyticsActionCauseList.resultsLayoutChange,{resultsLayoutChangeTo:t},this.element):(this.usageAnalytics.logSearchEvent(b.analyticsActionCauseList.resultsLayoutChange,{resultsLayoutChangeTo:t}),this.queryController.firstQuery||this.queryController.executeQuery())}},e.prototype.getCurrentLayout=function(){return this.currentLayout},e.prototype.disableLayouts=function(t){var e=this;if(f.Utils.isNonEmptyArray(t)){n.each(t,function(t){return e.disableLayout(t)});var o=n.difference(n.keys(this.currentActiveLayouts),t);if(n.isEmpty(o)){this.logger.error("Cannot disable the last valid layout ... Re-enabling the first one possible");var s=n.keys(this.currentActiveLayouts)[0];this.enableLayout(s),this.setLayout(s)}else{var i=n.contains(o,this.currentLayout)?this.currentLayout:o[0];this.changeLayout(i)}}},e.prototype.enableLayouts=function(t){var e=this;n.each(t,function(t){e.enableLayout(t)})},e.prototype.disableLayout=function(t){this.isLayoutDisplayedByButton(t)&&this.hideButton(t)},e.prototype.enableLayout=function(t){var e=this.resultLists;n.find(e,function(e){return e.options.layout==t})&&this.isLayoutDisplayedByButton(t)&&(this.showButton(t),this.updateSelectorAppearance())},Object.defineProperty(e.prototype,"resultLists",{get:function(){return this.searchInterface.getComponents("ResultList")},enumerable:!0,configurable:!0}),e.prototype.hideButton=function(t){if(this.isLayoutDisplayedByButton(t)){var e=this.currentActiveLayouts[t].button;d.$$(e.el).addClass("coveo-hidden"),e.visible=!1,this.updateSelectorAppearance()}},e.prototype.showButton=function(t){if(this.isLayoutDisplayedByButton(t)){var e=this.currentActiveLayouts[t].button;d.$$(e.el).removeClass("coveo-hidden"),e.visible=!0}},e.prototype.setLayout=function(t,e){t&&(this.currentLayout&&(d.$$(this.currentActiveLayouts[this.currentLayout].button.el).removeClass("coveo-selected"),d.$$(this.currentActiveLayouts[this.currentLayout].button.el).setAttribute("aria-pressed",(!1).toString())),d.$$(this.currentActiveLayouts[t].button.el).addClass("coveo-selected"),d.$$(this.currentActiveLayouts[t].button.el).setAttribute("aria-pressed",(!0).toString()),this.currentLayout=t,d.$$(this.element).trigger(r.ResultListEvents.changeLayout,{layout:t,results:e}))},e.prototype.handleQuerySuccess=function(t){this.hasNoResults=0==t.results.results.length,this.shouldShowSelector()?this.show():this.hide()},e.prototype.handleQueryStateChanged=function(t){var e=this.getModelValue(),o=n.find(n.keys(this.currentActiveLayouts),function(t){return t===e});void 0!==o?this.setLayout(o):this.setLayout(n.keys(this.currentActiveLayouts)[0])},e.prototype.handleQueryError=function(t){this.hasNoResults=!0,this.hide()},e.prototype.updateSelectorAppearance=function(){this.shouldShowSelector()?this.show():this.hide()},e.prototype.populate=function(){var t=this,o={layouts:[]};d.$$(this.root).trigger(a.ResultLayoutEvents.populateResultLayout,o);var s=n.uniq(o.layouts.map(function(t){return t.toLowerCase()}));n.each(s,function(t){return l.Assert.check(n.contains(e.validLayouts,t),"Invalid layout")}),n.isEmpty(s)||(n.each(s,function(e){return t.addButton(e)}),this.shouldShowSelector()||this.hide())},e.prototype.addButton=function(t){var e=this,o=d.$$("span",{className:"coveo-result-layout-selector"}),s=d.$$("span",{className:"coveo-result-layout-selector-caption"},p.l(t));o.append(s.el);var n=d.$$("span",{className:"coveo-icon coveo-"+t+"-layout-icon"},v.SVGIcons.icons[t+"Layout"]);L.SVGDom.addClassToSVGInContainer(n.el,"coveo-"+t+"-svg"),o.prepend(n.el);var i=function(){return e.changeLayout(t)};(new R.AccessibleButton).withElement(o).withLabel(p.l("DisplayResultsAs",p.l(t))).withSelectAction(i).withOwner(this.bind).build();var u=t===this.currentLayout;o.toggleClass("coveo-selected",u),o.setAttribute("aria-pressed",u.toString()),d.$$(this.element).append(o.el),this.currentActiveLayouts[t]={button:{visible:!0,el:o.el},enabled:!0}},e.prototype.hide=function(){var t=this.resultLayoutSection||this.element;d.$$(t).addClass("coveo-result-layout-hidden")},e.prototype.show=function(){var t=this.resultLayoutSection||this.element;d.$$(t).removeClass("coveo-result-layout-hidden")},e.prototype.getModelValue=function(){return this.queryStateModel.get(y.QueryStateModel.attributesEnum.layout)},e.prototype.setModelValue=function(t){this.queryStateModel.set(y.QueryStateModel.attributesEnum.layout,t)},e.prototype.shouldShowSelector=function(){return n.keys(this.currentActiveLayouts).length>1&&n.filter(this.currentActiveLayouts,function(t){return t.button.visible}).length>1&&!this.hasNoResults},e.prototype.isLayoutDisplayedByButton=function(t){return n.contains(n.keys(this.currentActiveLayouts),t)},e.ID="ResultLayoutSelector",e.aliases=["ResultLayout"],e.doExport=function(){h.exportGlobally({ResultLayoutSelector:e,ResultLayout:e})},e.validLayouts=["list","card","table"],e.options={mobileLayouts:g.ComponentOptions.buildListOption({defaultValue:["card","table"]}),tabletLayouts:g.ComponentOptions.buildListOption({defaultValue:["list","card","table"]}),desktopLayouts:g.ComponentOptions.buildListOption({defaultValue:["list","card","table"]})},e}(m.Component);e.ResultLayoutSelector=A,S.Initialization.registerAutoCreateComponent(A)},655:function(t,e){},656:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o(0),n=o(9),i=o(1),u=o(7),a=o(197),r=o(19),l=o(60),c=function(){function t(t,e,o,s){this.coveoRoot=t,this.ID=e,this.searchInterface=u.Component.get(this.coveoRoot.el,r.SearchInterface,!1)}return t.init=function(e,o,s){if(!i.$$(e).find("."+u.Component.computeCssClassName(a.ResultLayoutSelector))){return void new n.Logger("ResponsiveResultLayout").trace("No ResultLayout component found : Cannot instantiate ResponsiveResultLayout")}l.ResponsiveComponentsManager.register(t,i.$$(e),a.ResultLayoutSelector.ID,o,s)},t.prototype.registerComponent=function(t){return t instanceof a.ResultLayoutSelector&&(this.resultLayout=t,!0)},t.prototype.handleResizeEvent=function(){this.needSmallMode()?this.enableAndDisableLayouts(this.resultLayout.options.mobileLayouts):this.needMediumMode()?this.enableAndDisableLayouts(this.resultLayout.options.tabletLayouts):this.enableAndDisableLayouts(this.resultLayout.options.desktopLayouts)},t.prototype.enableAndDisableLayouts=function(t){var e=s.difference(a.ResultLayoutSelector.validLayouts,t),o=s.intersection(a.ResultLayoutSelector.validLayouts,t);this.resultLayout.disableLayouts(e),this.resultLayout.enableLayouts(o)},t.prototype.needSmallMode=function(){switch(this.searchInterface.responsiveComponents.getResponsiveMode()){case"small":return!0;case"auto":return this.coveoRoot.width()<=this.searchInterface.responsiveComponents.getSmallScreenWidth();default:return!1}},t.prototype.needMediumMode=function(){switch(this.searchInterface.responsiveComponents.getResponsiveMode()){case"medium":return!0;case"auto":return this.coveoRoot.width()<=this.searchInterface.responsiveComponents.getMediumScreenWidth();default:return!1}},t}();e.ResponsiveResultLayout=c}});
//# sourceMappingURL=ResultLayoutSelector.min__ab6807e9ec195c274856.js.map