{"version":3,"sources":["./src/ui/Settings/Settings.ts","./sass/_Settings.scss"],"names":[],"mappings":"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","file":"Settings__b6f3a40b26ad27101c27.js","sourcesContent":["import PopperJs from 'popper.js';\nimport 'styling/_Settings';\nimport { each, escape, times } from 'underscore';\nimport { InitializationEvents } from '../../events/InitializationEvents';\nimport { SettingsEvents } from '../../events/SettingsEvents';\nimport { exportGlobally } from '../../GlobalExports';\nimport { l } from '../../strings/Strings';\nimport { AccessibleButton } from '../../utils/AccessibleButton';\nimport { $$ } from '../../utils/Dom';\nimport { SVGDom } from '../../utils/SVGDom';\nimport { Component } from '../Base/Component';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { ComponentOptions } from '../Base/ComponentOptions';\nimport { Initialization } from '../Base/Initialization';\nimport { IMenuItem } from '../Menu/MenuItem';\n\nexport interface ISettingsPopulateMenuArgs {\n  settings: Settings;\n  menuData: IMenuItem[];\n}\n\nexport interface ISettingsOptions {\n  menuDelay: number;\n}\n\n/**\n * The Settings component renders a **Settings** button that the end user can click to access a popup menu from which\n * it is possible to perform several contextual actions. The usual location of the **Settings** button in the page is to\n * the right of the {@link Searchbox}.\n *\n * This component can reference several components to populate its popup menu:\n * - {@link AdvancedSearch}\n * - {@link ExportToExcel}\n * - {@link PreferencesPanel} (see also {@link ResultsFiltersPreferences} and {@link ResultsPreferences})\n * - {@link SearchAlerts} (see also {@link SearchAlertsMessage})\n * - {@link ShareQuery}\n */\nexport class Settings extends Component {\n  static ID = 'Settings';\n\n  static doExport = () => {\n    exportGlobally({\n      Settings: Settings\n    });\n  };\n\n  /**\n   * The options for Settings\n   * @componentOptions\n   */\n  static options: ISettingsOptions = {\n    /**\n     * Specifies the delay (in milliseconds) before hiding the popup menu when the cursor is not hovering over it.\n     *\n     * Default value is `300`. Minimum value is `0 `.\n     */\n    menuDelay: ComponentOptions.buildNumberOption({ defaultValue: 300, min: 0 })\n  };\n\n  private menu: HTMLElement;\n  private closeTimeout: number;\n  private isOpened: boolean = false;\n\n  /**\n   * Creates a new Settings component.\n   * @param element The HTMLElement on which to instantiate the component.\n   * @param options The options for the Settings component.\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\n   * automatically resolved (with a slower execution time).\n   */\n  constructor(public element: HTMLElement, public options: ISettingsOptions, bindings?: IComponentBindings) {\n    super(element, Settings.ID, bindings);\n    this.options = ComponentOptions.initComponentOptions(element, Settings, options);\n    this.bind.onRootElement(InitializationEvents.afterInitialization, () => this.init());\n  }\n\n  /**\n   * Opens the **Settings** popup menu.\n   */\n  public open() {\n    this.isOpened = true;\n    if (this.menu != null) {\n      $$(this.menu).detach();\n    }\n\n    this.menu = this.buildMenu();\n    $$(this.menu).insertAfter(this.element);\n\n    new PopperJs(this.element, this.menu, {\n      placement: 'bottom-end',\n      modifiers: {\n        offset: {\n          offset: '0, 5'\n        },\n        preventOverflow: {\n          boundariesElement: this.root\n        }\n      }\n    });\n  }\n\n  /**\n   * Closes the **Settings** popup menu.\n   */\n  public close() {\n    this.isOpened = false;\n    if (this.menu != null) {\n      $$(this.menu).detach();\n      this.menu = null;\n    }\n  }\n\n  private toggle() {\n    if (this.isOpened) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  private init() {\n    const square = $$('span', { className: 'coveo-settings-square' }).el;\n    const squares = $$('span', { className: 'coveo-settings-squares' }).el;\n    times(3, () => squares.appendChild(square.cloneNode()));\n    this.element.appendChild(squares);\n\n    new AccessibleButton()\n      .withElement(this.element)\n      .withOwner(this.bind)\n      .withSelectAction(() => this.toggle())\n      .withFocusAndMouseEnterAction(() => this.onfocus())\n      .withBlurAndMouseLeaveAction(() => this.onblur())\n      .withLabel(l('Settings'))\n      .build();\n  }\n\n  private buildMenu(): HTMLElement {\n    const menu = $$('div', { className: 'coveo-settings-advanced-menu' }).el;\n    const settingsPopulateMenuArgs: ISettingsPopulateMenuArgs = {\n      settings: this,\n      menuData: []\n    };\n    $$(this.root).trigger(SettingsEvents.settingsPopulateMenu, settingsPopulateMenuArgs);\n\n    each(settingsPopulateMenuArgs.menuData, menuItem => {\n      const { menuItemElement, menuItemIcon, menuItemText } = this.buildMenuItem(menuItem, settingsPopulateMenuArgs);\n\n      menuItemElement.appendChild(menuItemIcon);\n      menuItemElement.appendChild(menuItemText);\n\n      menu.appendChild(menuItemElement);\n    });\n    return menu;\n  }\n\n  private buildMenuItem(menuItem: IMenuItem, settingsPopulateMenuArgs: ISettingsPopulateMenuArgs) {\n    const menuItemElement = $$('div', {\n      className: `coveo-settings-item ${menuItem.className}`\n    }).el;\n\n    const selectAction = () => {\n      each(settingsPopulateMenuArgs.menuData, menuItem => {\n        menuItem.onClose && menuItem.onClose();\n      });\n      this.close();\n      menuItem.onOpen();\n    };\n\n    new AccessibleButton()\n      .withElement(menuItemElement)\n      .withSelectAction(selectAction)\n      .withFocusAndMouseEnterAction(() => this.onfocus())\n      .withBlurAndMouseLeaveAction(() => this.onblur())\n      .withLabel(menuItem.tooltip || menuItem.text)\n      .build();\n\n    return {\n      menuItemElement,\n      menuItemIcon: this.buildMenuItemIcon(menuItem),\n      menuItemText: this.buildMenuItemText(menuItem)\n    };\n  }\n\n  private buildMenuItemIcon(menuItem: IMenuItem) {\n    const iconElement = $$('div', {\n      className: 'coveo-icon'\n    }).el;\n\n    if (menuItem.svgIcon) {\n      iconElement.innerHTML = menuItem.svgIcon;\n    }\n\n    if (menuItem.svgIconClassName) {\n      SVGDom.addClassToSVGInContainer(iconElement, menuItem.svgIconClassName);\n    }\n\n    return iconElement;\n  }\n\n  private buildMenuItemText(menuItem: IMenuItem) {\n    const textElement = $$(\n      'div',\n      {\n        className: 'coveo-settings-text'\n      },\n      escape(menuItem.text)\n    ).el;\n\n    return textElement;\n  }\n\n  private onblur() {\n    clearTimeout(this.closeTimeout);\n    this.closeTimeout = window.setTimeout(() => {\n      this.close();\n    }, this.options.menuDelay);\n  }\n\n  private onfocus() {\n    clearTimeout(this.closeTimeout);\n  }\n}\nInitialization.registerAutoCreateComponent(Settings);\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Settings/Settings.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_Settings.scss\n// module id = 666\n// module chunks = 60 88"],"sourceRoot":""}