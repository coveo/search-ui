webpackJsonpCoveo__temporary([7,9,37,38],{16:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.addClassToSVGInContainer=function(e,n){var i=e.querySelector("svg");i.setAttribute("class",""+t.getClass(i)+n)},t.removeClassFromSVGInContainer=function(e,n){var i=e.querySelector("svg");i.setAttribute("class",t.getClass(i).replace(n,""))},t.getClass=function(t){var e=t.getAttribute("class");return e?e+" ":""},t}();e.SVGDom=i},250:function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=n(8),o=n(5),r=n(3),u=n(10),a=n(12),l=n(2),c=n(4),p=n(15),h=n(16),g=function(t){function e(n,i,s){var a=t.call(this,n,e.ID,s)||this;if(a.element=n,a.options=i,r.$$(n).setAttribute("aria-label",u.l("Search")),a.bind.on(n,"click",function(){return a.handleClick()}),""==o.Utils.trim(r.$$(a.element).text())){var l=r.$$("span",{className:"coveo-search-button"},p.SVGIcons.icons.search).el;h.SVGDom.addClassToSVGInContainer(l,"coveo-search-button-svg");var c=r.$$("span",{className:"coveo-search-button-loading"},p.SVGIcons.icons.loading).el;h.SVGDom.addClassToSVGInContainer(c,"coveo-search-button-loading-svg"),n.appendChild(l),n.appendChild(c)}return a}return i(e,t),e.prototype.click=function(){this.handleClick()},e.prototype.handleClick=function(){this.logger.debug("Performing query following button click"),this.usageAnalytics.logSearchEvent(a.analyticsActionCauseList.searchboxSubmit,{}),this.queryController.executeQuery()},e}(s.Component);g.ID="SearchButton",g.doExport=function(){c.exportGlobally({SearchButton:g})},g.options={},e.SearchButton=g,l.Initialization.registerAutoCreateComponent(g)},324:function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=n(8),o=n(81),r=n(9),u=n(250),a=n(97),l=n(3),c=n(2),p=n(1),h=n(4);n(613);var g=n(15),d=n(16),f=function(t){function e(n,i,s){var c=t.call(this,n,e.ID,s)||this;if(c.element=n,c.options=i,c.options=r.ComponentOptions.initComponentOptions(n,e,i),c.options.inline&&l.$$(n).addClass("coveo-inline"),c.options.addSearchButton){var p=document.createElement("a");c.element.appendChild(p),c.searchButton=new u.SearchButton(p,void 0,s)}var h=document.createElement("div");c.element.appendChild(h),c.options.enableOmnibox?c.searchbox=new o.Omnibox(h,c.options,s):c.searchbox=new a.Querybox(h,c.options,s);var f=l.$$(c.element).find(".magic-box-icon");return f.innerHTML=g.SVGIcons.icons.mainClear,d.SVGDom.addClassToSVGInContainer(f,"magic-box-clear-svg"),c}return i(e,t),e}(s.Component);f.ID="Searchbox",f.parent=o.Omnibox,f.doExport=function(){h.exportGlobally({Searchbox:f,SearchButton:u.SearchButton,Omnibox:o.Omnibox,Querybox:a.Querybox})},f.options={addSearchButton:r.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableOmnibox:r.ComponentOptions.buildBooleanOption({defaultValue:!0})},e.Searchbox=f,f.options=p.extend({},f.options,o.Omnibox.options,a.Querybox.options),p.each(f.options,function(t,e){e in o.Omnibox.options&&!(e in a.Querybox.options)&&(f.options[e]=p.extend({depend:"enableOmnibox"},t))}),c.Initialization.registerAutoCreateComponent(f)},429:function(t,e,n){(function(e){var n,i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};!function(t){!function(t){var e=function(){function e(t,e,n){var i=this;this.expression=e,this.input=n,_.isString(t)?this.value=t:_.isArray(t)&&(this.subResults=t,_.forEach(this.subResults,function(t){t.parent=i}))}return e.prototype.isSuccess=function(){return null!=this.value||null!=this.subResults&&_.all(this.subResults,function(t){return t.isSuccess()})},e.prototype.path=function(t){var e=null!=this.parent&&this.parent!=t?this.parent.path(t):[];return e.push(this),e},e.prototype.findParent=function(t){for(var e=this,n=_.isString(t)?function(e){return t==e.expression.id}:t;null!=e&&!n(e);)e=e.parent;return e},e.prototype.find=function(t){var e=_.isString(t)?function(e){return t==e.expression.id}:t;if(e(this))return this;if(this.subResults)for(var n=0;n<this.subResults.length;n++){var i=this.subResults[n].find(e);if(i)return i}return null},e.prototype.findAll=function(t){var e=[],n=_.isString(t)?function(e){return t==e.expression.id}:t;return n(this)&&e.push(this),this.subResults&&(e=_.reduce(this.subResults,function(t,e){return t.concat(e.findAll(n))},e)),e},e.prototype.resultAt=function(t,e){if(t<0||t>this.getLength())return[];if(null!=e){if(_.isString(e)){if(e==this.expression.id)return[this]}else if(e(this))return[this]}else{if(null!=(null==this.value&&null==this.subResults?this.input:this.value))return[this]}if(null!=this.subResults){for(var n=[],i=0;i<this.subResults.length;i++){var s=this.subResults[i];if(n=n.concat(s.resultAt(t,e)),(t-=s.getLength())<0)break}return n}return[]},e.prototype.getExpect=function(){return null==this.value&&null==this.subResults?[this]:null!=this.subResults?_.reduce(this.subResults,function(t,e){return t.concat(e.getExpect())},[]):[]},e.prototype.getBestExpect=function(){var t=this.getExpect(),e=_.groupBy(t,function(t){return t.input}),n=_.last(_.keys(e).sort(function(t,e){return e.length-t.length})),i=e[n],e=_.groupBy(i,function(t){return t.expression.id});return _.map(e,function(t){return _.chain(t).map(function(t){return{path:t.path().length,result:t}}).sortBy("path").pluck("result").first().value()})},e.prototype.getHumanReadableExpect=function(){var t=this.getBestExpect(),e=t.length>0?_.last(t).input:"";return"Expected "+_.map(t,function(t){return t.getHumanReadable()}).join(" or ")+" but "+(e.length>0?JSON.stringify(e[0]):"end of input")+" found."},e.prototype.before=function(){if(null==this.parent)return"";var t=_.indexOf(this.parent.subResults,this);return this.parent.before()+_.chain(this.parent.subResults).first(t).map(function(t){return t.toString()}).join("").value()},e.prototype.after=function(){if(null==this.parent)return"";var t=_.indexOf(this.parent.subResults,this);return _.chain(this.parent.subResults).last(this.parent.subResults.length-t-1).map(function(t){return t.toString()}).join("").value()+this.parent.after()},e.prototype.getLength=function(){return null!=this.value?this.value.length:null!=this.subResults?_.reduce(this.subResults,function(t,e){return t+e.getLength()},0):this.input.length},e.prototype.toHtmlElement=function(){var t=document.createElement("span"),e=null!=this.expression?this.expression.id:null;return null!=e&&t.setAttribute("data-id",e),t.setAttribute("data-success",this.isSuccess().toString()),null!=this.value?(t.appendChild(document.createTextNode(this.value)),t.setAttribute("data-value",this.value)):null!=this.subResults?_.each(this.subResults,function(e){t.appendChild(e.toHtmlElement())}):(t.appendChild(document.createTextNode(this.input)),t.setAttribute("data-input",this.input),t.className="magic-box-error"+(this.input.length>0?"":" magic-box-error-empty")),t.result=this,t},e.prototype.clean=function(t){if(null!=t||!this.isSuccess()){t=t||_.last(this.getBestExpect()).path(this);var n=_.first(t);if(null!=n){var i=_.indexOf(this.subResults,n),s=-1==i?[]:_.map(_.first(this.subResults,i),function(t){return t.clean()});return s.push(n.clean(_.rest(t))),new e(s,this.expression,this.input)}return new e(null,this.expression,this.input)}return null!=this.value?new e(this.value,this.expression,this.input):null!=this.subResults?new e(_.map(this.subResults,function(t){return t.clean()}),this.expression,this.input):void 0},e.prototype.clone=function(){return null!=this.value?new e(this.value,this.expression,this.input):null!=this.subResults?new e(_.map(this.subResults,function(t){return t.clone()}),this.expression,this.input):new e(null,this.expression,this.input)},e.prototype.toString=function(){return null!=this.value?this.value:null!=this.subResults?_.map(this.subResults,function(t){return t.toString()}).join(""):this.input},e.prototype.getHumanReadable=function(){return this.expression instanceof t.ExpressionConstant?JSON.stringify(this.expression.value):this.expression.id},e}();t.Result=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(e){function n(n){e.call(this,[n],t.ExpressionEndOfInput,n.input);var i=new t.Result(null,t.ExpressionEndOfInput,n.input.substr(n.getLength()));i.parent=this,this.subResults.push(i)}return i(n,e),n}(t.Result);t.EndOfInputResult=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(e){function n(t,n,i,s){var o=this;e.call(this,null!=t?[t]:null,n,i),this.result=t,this.expression=n,this.input=i,this.failAttempt=s,_.forEach(this.failAttempt,function(t){t.parent=o})}return i(n,e),n.prototype.getExpect=function(){var t=this,e=[];return null!=this.result&&(e=this.result.getExpect()),e=_.reduce(this.failAttempt,function(t,e){return t.concat(e.getExpect())},e),e.length>0&&_.all(e,function(e){return e.input==t.input})?[this]:e},n.prototype.clean=function(e){if(null!=e||!this.isSuccess()){e=_.rest(e||_.last(this.getBestExpect()).path(this));var n=_.first(e);return null==n?new t.Result(null,this.expression,this.input):new t.Result([n.clean(_.rest(e))],this.expression,this.input)}return new t.Result(_.map(this.result.subResults,function(t){return t.clean()}),this.expression,this.input)},n}(t.Result);t.OptionResult=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(e){function n(t,n,i,s){e.call(this,t,n,i),this.results=t,this.expression=n,this.input=i,_.last(t)!=s&&(this.failAttempt=s,null!=this.failAttempt&&(this.failAttempt.parent=this))}return i(n,e),n.prototype.getExpect=function(){var t=e.prototype.getExpect.call(this);return null!=this.failAttempt?t.concat(this.failAttempt.getExpect()):t},n.prototype.clean=function(n){if(null!=this.failAttempt&&(null!=n||!this.isSuccess())){n=n||_.last(this.getBestExpect()).path(this);var i=_.first(n);if(null!=i&&i==this.failAttempt){var s=_.last(this.subResults),o=_.map(null!=s&&s.isSuccess()?this.subResults:_.initial(this.subResults),function(t){return t.clean()});return o.push(i.clean(_.rest(n))),new t.Result(o,this.expression,this.input)}}return e.prototype.clean.call(this,n)},n}(t.Result);t.RefResult=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(){function e(t,e){this.value=t,this.id=e}return e.prototype.parse=function(e,n){var i=0==e.indexOf(this.value),s=new t.Result(i?this.value:null,this,e);return i&&n&&e.length>this.value.length?new t.EndOfInputResult(s):s},e.prototype.toString=function(){return this.value},e}();t.ExpressionConstant=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){t.ExpressionEndOfInput={id:"end of input",parse:null}}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(){function t(t,e,n){this.func=t,this.id=e,this.grammar=n}return t.prototype.parse=function(t,e){return this.func(t,e,this)},t.prototype.toString=function(){return this.id},t}();t.ExpressionFunction=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(){function e(t,e){if(this.parts=t,this.id=e,0==t.length)throw JSON.stringify(e)+" should have at least 1 parts"}return e.prototype.parse=function(e,n){for(var i,s=[],o=e,r=0;r<this.parts.length;r++){if(i=this.parts[r].parse(o,n&&r==this.parts.length-1),s.push(i),!i.isSuccess())break;o=o.substr(i.getLength())}return new t.Result(s,this,e)},e.prototype.toString=function(){return this.id},e}();t.ExpressionList=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(){function e(t,e){this.parts=t,this.id=e}return e.prototype.parse=function(e,n){for(var i=[],s=0;s<this.parts.length;s++){var o=this.parts[s].parse(e,n);if(o.isSuccess())return new t.OptionResult(o,this,e,i);i.push(o)}return new t.OptionResult(null,this,e,i)},e.prototype.toString=function(){return this.id},e}();t.ExpressionOptions=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(){function e(t,e,n,i){this.ref=t,this.occurrence=e,this.id=n,this.grammar=i}return e.prototype.parse=function(t,e){var n=this.grammar.getExpression(this.ref);if(null==n)throw"Expression not found:"+this.ref;return"?"==this.occurrence||null==this.occurrence?this.parseOnce(t,e,n):this.parseMany(t,e,n)},e.prototype.parseOnce=function(e,n,i){var s=i.parse(e,n),o=s.isSuccess();return o||"?"!=this.occurrence?new t.RefResult([s],this,e,o?null:s):n?0==e.length?new t.RefResult([],this,e,s):_.all(s.getBestExpect(),function(e){return e.expression==t.ExpressionEndOfInput})?new t.RefResult([new t.Result(null,t.ExpressionEndOfInput,e)],this,e,s):s:new t.RefResult([],this,e,null)},e.prototype.parseMany=function(e,n,i){var s,o,r=[],u=e;do{s=i.parse(u,!1),(o=s.isSuccess())&&(r.push(s),u=u.substr(s.getLength()))}while(o&&s.input!=u);var a=_.isNumber(this.occurrence)?this.occurrence:"+"==this.occurrence?1:0;if(r.length<a)r.push(s);else if(n)if(r.length>0){var l=_.last(r);s=i.parse(l.input,!0),s.isSuccess()?r[r.length-1]=s:(r.push(new t.Result(null,t.ExpressionEndOfInput,l.input.substr(l.getLength()))),s=i.parse(l.input.substr(l.getLength()),!0))}else if(0!=e.length){var c=new t.Result(null,t.ExpressionEndOfInput,e);return new t.RefResult([c],this,e,s)}return new t.RefResult(r,this,e,s)},e.prototype.toString=function(){return this.id},e}();t.ExpressionRef=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(){function e(t,e,n){this.value=t,this.id=e}return e.prototype.parse=function(e,n){var i=e.match(this.value);null!=i&&0!=i.index&&(i=null);var s=new t.Result(null!=i?i[0]:null,this,e);return s.isSuccess()&&n&&e.length>s.value.length?new t.EndOfInputResult(s):s},e.prototype.toString=function(){return this.id},e}();t.ExpressionRegExp=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(){function e(e,n){void 0===n&&(n={}),this.expressions={},this.start=new t.ExpressionRef(e,null,"start",this),this.addExpressions(n)}return e.prototype.addExpressions=function(t){var e=this;_.each(t,function(t,n){e.addExpression(n,t)})},e.prototype.addExpression=function(t,n){if(t in this.expressions)throw"Grammar already contain the id:"+t;this.expressions[t]=e.buildExpression(n,t,this)},e.prototype.getExpression=function(t){return this.expressions[t]},e.prototype.parse=function(t){return this.start.parse(t,!0)},e.buildExpression=function(e,n,i){if(void 0===e)throw"Invalid Expression: "+e;if(_.isString(e))return this.buildStringExpression(e,n,i);if(_.isArray(e))return new t.ExpressionOptions(_.map(e,function(e,s){return new t.ExpressionRef(e,null,n+"_"+s,i)}),n);if(_.isRegExp(e))return new t.ExpressionRegExp(e,n,i);if(_.isFunction(e))return new t.ExpressionFunction(e,n,i);throw"Invalid Expression: "+e},e.buildStringExpression=function(n,i,s){var o=e.stringMatch(n,e.spliter),r=_.map(o,function(e,n){if(e[1]){var o=e[1],r=e[3]?Number(e[3]):e[2]||null;return new t.ExpressionRef(o,r,i+"_"+n,s)}return new t.ExpressionConstant(e[4],i+"_"+n)});if(1==r.length){var u=r[0];return u.id=i,u}return new t.ExpressionList(r,i)},e.stringMatch=function(t,e){for(var n,i=[],s=new RegExp(e.source,"g");null!==(n=s.exec(t));)i.push(n);return i},e.spliter=/\[(\w+)(\*|\+|\?|\{([1-9][0-9]*)\})?\]|(.[^\[]*)/,e}();t.Grammar=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var e=function(){function e(e,n,i){this.element=e,this.onchange=n,this.magicBox=i,this.hasFocus=!1,this.justPressedTab=!1,this.underlay=document.createElement("div"),this.underlay.className="magic-box-underlay",this.highlightContainer=document.createElement("span"),this.highlightContainer.className="magic-box-highlight-container",this.underlay.appendChild(this.highlightContainer),this.ghostTextContainer=document.createElement("span"),this.ghostTextContainer.className="magic-box-ghost-text",this.underlay.appendChild(this.ghostTextContainer),this.input=t.$$(e).find("input"),this.input?e.insertBefore(this.underlay,this.input):(this.input=document.createElement("input"),e.appendChild(this.underlay),e.appendChild(this.input)),this.input.spellcheck=!1,this.input.setAttribute("form","coveo-dummy-form"),this.input.setAttribute("autocomplete","off"),this.setupHandler()}return e.prototype.updateInput=function(){this.input.value!=this.result.input&&(this.input.value=this.result.input,this.hasFocus&&this.setCursor(this.getValue().length))},e.prototype.updateHighlight=function(){this.highlightContainer.innerHTML="",this.highlightContainer.appendChild(this.result.toHtmlElement())},e.prototype.updateWordCompletion=function(){this.ghostTextContainer.innerHTML="",null!=this.wordCompletion&&this.ghostTextContainer.appendChild(document.createTextNode(this.wordCompletion.substr(this.result.input.length)))},e.prototype.updateScroll=function(e){var n=this;void 0===e&&(e=!0);var i=function(){n.underlay.clientWidth<n.underlay.scrollWidth&&(n.underlay.style.visibility="hidden",n.underlay.scrollLeft=n.input.scrollLeft,n.underlay.scrollTop=n.input.scrollTop,n.underlay.style.visibility="visible"),n.updateScrollDefer=null,n.hasFocus&&n.updateScroll()};e?null==this.updateScrollDefer&&(this.updateScrollDefer=t.requestAnimationFrame(i)):i()},e.prototype.setResult=function(t,e){this.result=t,this.updateInput(),this.updateHighlight(),_.isUndefined(e)&&null!=this.wordCompletion&&0==this.wordCompletion.indexOf(this.result.input)?this.updateWordCompletion():this.setWordCompletion(e),this.updateScroll()},e.prototype.setWordCompletion=function(t){null!=t&&0!=t.toLowerCase().indexOf(this.result.input.toLowerCase())&&(t=null),this.wordCompletion=t,this.updateWordCompletion(),this.updateScroll()},e.prototype.setCursor=function(t){if(this.input.focus(),this.input.createTextRange){var e=this.input.createTextRange();e.move("character",t),e.select()}else null!=this.input.selectionStart&&(this.input.focus(),this.input.setSelectionRange(t,t))},e.prototype.getCursor=function(){return this.input.selectionStart},e.prototype.setupHandler=function(){var t=this;this.input.onblur=function(){t.hasFocus=!1,setTimeout(function(){t.hasFocus||t.onblur&&t.onblur()},300),t.updateScroll()},this.input.onfocus=function(){t.hasFocus||(t.hasFocus=!0,t.updateScroll(),t.onfocus&&t.onfocus())},this.input.onkeydown=function(e){t.keydown(e)},this.input.onkeyup=function(e){t.keyup(e)},this.input.onclick=function(){t.onchangecursor()},this.input.oncut=function(){setTimeout(function(){t.onInputChange()})},this.input.onpaste=function(){setTimeout(function(){t.onInputChange()})}},e.prototype.focus=function(){var t=this;this.hasFocus=!0,setTimeout(function(){t.input.focus(),t.setCursor(t.getValue().length)})},e.prototype.blur=function(){this.hasFocus&&this.input.blur()},e.prototype.keydown=function(e){var n=this;switch(e.keyCode||e.which){case 9:this.justPressedTab?this.blur():this.magicBox.hasSuggestions()&&e.preventDefault(),this.justPressedTab=!0;break;default:e.stopPropagation(),this.justPressedTab=!1,null==this.onkeydown||this.onkeydown(e.keyCode||e.which)?t.requestAnimationFrame(function(){n.onInputChange()}):e.preventDefault()}},e.prototype.keyup=function(t){switch(t.keyCode||t.which){case 9:this.tabPress();break;case 37:case 39:this.onchangecursor();break;default:null==this.onkeydown||this.onkeyup(t.keyCode||t.which)?this.onInputChange():t.preventDefault()}},e.prototype.tabPress=function(){null!=this.wordCompletion&&(this.input.value=this.wordCompletion),this.ontabpress&&this.ontabpress(),this.magicBox.showSuggestion()},e.prototype.onInputChange=function(){this.result.input!=this.input.value&&this.onchange(this.input.value,!1)},e.prototype.getValue=function(){return this.input.value},e.prototype.getWordCompletion=function(){return this.wordCompletion},e}();t.InputManager=e}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){var n=function(){function n(e,n){var i=this;this.element=e,this.options=_.defaults(n,{selectableClass:"magic-box-suggestion",selectedClass:"magic-box-selected"}),void 0==this.options.timeout&&(this.options.timeout=500),this.hasSuggestions=!1,t.$$(this.element).on("mouseover",function(t){i.handleMouseOver(t)}),t.$$(this.element).on("mouseout",function(t){i.handleMouseOut(t)})}return n.prototype.handleMouseOver=function(e){var n=t.$$(e.target),i=n.parents(this.options.selectableClass);n.hasClass(this.options.selectableClass)?this.addSelectedClass(n.el):i.length>0&&this.element.contains(i[0])&&this.addSelectedClass(i[0])},n.prototype.handleMouseOut=function(e){var n=t.$$(e.target),i=n.parents(this.options.selectableClass);if(e.relatedTarget){var s=t.$$(e.relatedTarget).parents(this.options.selectableClass);n.hasClass(this.options.selectedClass)&&!t.$$(e.relatedTarget).hasClass(this.options.selectableClass)?n.removeClass(this.options.selectedClass):0==s.length&&i.length>0&&t.$$(i[0]).removeClass(this.options.selectedClass)}else n.hasClass(this.options.selectedClass)?n.removeClass(this.options.selectedClass):i.length>0&&t.$$(i[0]).removeClass(this.options.selectedClass)},n.prototype.moveDown=function(){var e=this.element.getElementsByClassName(this.options.selectedClass).item(0),n=this.element.getElementsByClassName(this.options.selectableClass),i=-1;if(null!=e){t.$$(e).removeClass(this.options.selectedClass);for(var s=0;s<n.length;s++)if(e==n.item(s)){i=s;break}i=-1==i?0:i+1}else i=0;return e=n.item(i),null!=e&&t.$$(e).addClass(this.options.selectedClass),this.returnMoved(e)},n.prototype.moveUp=function(){var e=this.element.getElementsByClassName(this.options.selectedClass).item(0),n=this.element.getElementsByClassName(this.options.selectableClass),i=-1;if(null!=e){t.$$(e).removeClass(this.options.selectedClass);for(var s=0;s<n.length;s++)if(e==n.item(s)){i=s;break}i=-1==i?n.length-1:i-1}else i=n.length-1;return e=n.item(i),null!=e&&t.$$(e).addClass(this.options.selectedClass),this.returnMoved(e)},n.prototype.select=function(){var e=this.element.getElementsByClassName(this.options.selectedClass).item(0);return null!=e&&t.$$(e).trigger("keyboardSelect"),e},n.prototype.mergeSuggestions=function(t,n){var i,s=this,o=[];t=_.compact(t);var r=this.pendingSuggestion=new e(function(n,u){_.each(t,function(t){var e=!1;setTimeout(function(){e=!0},s.options.timeout),t.then(function(t){!e&&t&&(o=o.concat(t))})});var a=function(){i&&clearTimeout(i),0==o.length?n([]):r==s.pendingSuggestion||null==s.pendingSuggestion?n(o.sort(function(t,e){return e.index-t.index})):u("new request queued")};0==t.length&&a(),void 0==t&&a(),i=setTimeout(function(){a()},s.options.timeout),e.all(t).then(function(){return a()})});r.then(function(t){return n&&n(t),s.updateSuggestions(t),t}).catch(function(){return null})},n.prototype.updateSuggestions=function(e){var n=this;this.element.innerHTML="",this.element.className="magic-box-suggestions",_.each(e,function(e){var i=e.dom;if(i){t.$$(i).removeClass(n.options.selectedClass);var s=t.$$(i).find("."+n.options.selectableClass);t.$$(s).removeClass(n.options.selectedClass)}else{if(i=document.createElement("div"),i.className="magic-box-suggestion",null!=e.html)i.innerHTML=e.html;else if(null!=e.text)i.appendChild(document.createTextNode(e.text));else if(null!=e.separator){i.className="magic-box-suggestion-seperator";var o=document.createElement("div");o.className="magic-box-suggestion-seperator-label",o.appendChild(document.createTextNode(e.separator)),i.appendChild(o)}t.$$(i).on("click",function(){e.onSelect()}),t.$$(i).on("keyboardSelect",function(){e.onSelect()}),t.$$(i).addClass(n.options.selectableClass)}i.suggestion=e,n.element.appendChild(i)}),e.length>0?(t.$$(this.element).addClass("magic-box-hasSuggestion"),this.hasSuggestions=!0):(t.$$(this.element).removeClass("magic-box-hasSuggestion"),this.hasSuggestions=!1)},n.prototype.returnMoved=function(e){if(null!=e){if(e.suggestion)return e.suggestion;if(e["no-text-suggestion"])return null;if(e instanceof HTMLElement)return{text:t.$$(e).text()}}return null},n.prototype.addSelectedClass=function(e){for(var n=this.element.getElementsByClassName(this.options.selectedClass),i=0;i<n.length;i++){var s=n.item(i);t.$$(s).removeClass(this.options.selectedClass)}t.$$(e).addClass(this.options.selectedClass)},n}();t.SuggestionsManager=n}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){!function(e){function n(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function i(t,e,i,o,r){if(void 0===i&&(i=!1),void 0===o&&(o="magic-box-hightlight"),void 0===r&&(r=""),0==e.length)return t;var u=n(e),a="("+u+")|(.*?(?="+u+")|.+)",l=new RegExp(a,i?"gi":"g");return t.replace(l,function(t,e,n){return s(null!=e?o:r,t)})}var s=function(t,e){return'<span class="'+t+'">'+_.escape(e)+"</span>"};e.highlightText=i;var o=function(){function e(t){this.el=t}return e.prototype.text=function(t){return t?void(void 0!=this.el.innerText?this.el.innerText=t:void 0!=this.el.textContent&&(this.el.textContent=t)):this.el.innerText||this.el.textContent},e.prototype.nodeListToArray=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t.item(e);return n},e.prototype.empty=function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild)},e.prototype.show=function(){this.el.style.display="visible"},e.prototype.hide=function(){this.el.style.display="none"},e.prototype.toggle=function(t){void 0===t?"visible"==this.el.style.display?this.hide():this.show():t?this.show():this.hide()},e.prototype.find=function(t){return this.el.querySelector(t)},e.prototype.is=function(t){return this.el.tagName.toLowerCase()==t.toLowerCase()||!("."!=t[0]||!this.hasClass(t.substr(1)))||"#"==t[0]&&this.el.getAttribute("id")==t.substr(1)},e.prototype.closest=function(e){for(var n=this.el,i=!1;!i&&(t.$$(n).hasClass(e)&&(i=!0),"body"!=n.tagName.toLowerCase())&&null!=n.parentElement;)i||(n=n.parentElement);if(i)return n},e.prototype.parent=function(t){if(void 0!=this.el.parentElement)return this.traverseAncestorForClass(this.el.parentElement,t)},e.prototype.parents=function(t){for(var n=[],i=this.parent(t);i;)n.push(i),i=new e(i).parent(t);return n},e.prototype.findAll=function(t){return this.nodeListToArray(this.el.querySelectorAll(t))},e.prototype.findClass=function(t){return"getElementsByClassName"in this.el?this.nodeListToArray(this.el.getElementsByClassName(t)):this.nodeListToArray(this.el.querySelectorAll("."+t))},e.prototype.findId=function(t){return document.getElementById(t)},e.prototype.addClass=function(t){this.hasClass(t)||(this.el.className?this.el.className+=" "+t:this.el.className=t)},e.prototype.removeClass=function(t){this.el.className=this.el.className.replace(new RegExp("(^|\\s)"+t+"(\\s|\\b)","g"),"$1")},e.prototype.toggleClass=function(t,e){e?this.addClass(t):this.removeClass(t)},e.prototype.getClass=function(){return this.el.className.match(e.CLASS_NAME_REGEX)||[]},e.prototype.hasClass=function(t){return _.contains(this.getClass(),t)},e.prototype.detach=function(){this.el.parentElement&&this.el.parentElement.removeChild(this.el)},e.prototype.on=function(t,n){var i=this;if(_.isArray(t))_.each(t,function(t){i.on(t,n)});else{var s=this.getJQuery();if(s)s(this.el).on(t,n);else if(this.el.addEventListener){var o=function(t){n(t,t.detail)};e.handlers.push({eventHandle:n,fn:o}),this.el.addEventListener(t,o,!1)}else this.el.on&&this.el.on("on"+t,n)}},e.prototype.one=function(t,e){var n=this;if(_.isArray(t))_.each(t,function(t){n.one(t,e)});else{var i=function(s){return n.off(t,i),e(s)};this.on(t,i)}},e.prototype.off=function(t,n){var i=this;if(_.isArray(t))_.each(t,function(t){i.off(t,n)});else{var s=this.getJQuery();if(s)s(this.el).off(t,n);else if(this.el.removeEventListener){var o=0,r=_.find(e.handlers,function(t,e){if(t.eventHandle==n)return o=e,!0});r&&(this.el.removeEventListener(t,r.fn,!1),e.handlers.splice(o,1))}else this.el.off&&this.el.off("on"+t,n)}},e.prototype.trigger=function(t,e){var n=this.getJQuery();if(n)n(this.el).trigger(t,e);else if(void 0!==CustomEvent){var i=new CustomEvent(t,{detail:e,bubbles:!0});this.el.dispatchEvent(i)}},e.prototype.isEmpty=function(){return e.ONLY_WHITE_SPACE_REGEX.test(this.el.innerHTML)},e.prototype.isDescendant=function(t){for(var e=this.el.parentNode;null!=e;){if(e==t)return!0;e=e.parentNode}return!1},e.prototype.traverseAncestorForClass=function(e,n){void 0===e&&(e=this.el),0==n.indexOf(".")&&(n=n.substr(1));for(var i=!1;!i&&(t.$$(e).hasClass(n)&&(i=!0),"body"!=e.tagName.toLowerCase())&&null!=e.parentElement;)i||(e=e.parentElement);if(i)return e},e.prototype.getJQuery=function(){return void 0!=window.jQuery&&window.jQuery},e.CLASS_NAME_REGEX=/-?[_a-zA-Z]+[_a-zA-Z0-9-]*/g,e.ONLY_WHITE_SPACE_REGEX=/^\s*$/,e.handlers=[],e}();e.Dom=o}(t.Utils||(t.Utils={}))}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){t.$$=function(e){return window.Coveo&&window.Coveo.$$?window.Coveo.$$(e):new t.Utils.Dom(e)}}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){!function(e){function n(t,e,n,i){_.each(i.expressions,function(e){_.contains(t,e)||t.push(e)}),_.each(i.basicExpressions,function(t){_.contains(e,t)||e.push(t)}),_.each(i.grammars,function(t,e){if(e in n){if(!_.isArray(n[e])||!_.isArray(t))throw _.each(t,function(t){n[e].push(t)}),"Can not merge "+e+"("+new String(t)+" => "+new String(n[e])+")";_.each(t,function(t){n[e].push(t)})}else n[e]=t})}function i(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var i=[],s=[],o={Start:["Expressions","Empty"],Expressions:"[OptionalSpaces][Expression][ExpressionsList*][OptionalSpaces]",ExpressionsList:"[Spaces][Expression]",Expression:i,BasicExpression:s,OptionalSpaces:/ */,Spaces:/ +/,Empty:/(?!.)/},r=0;r<t.length;r++)n(i,s,o,t[r]),_.each(t[r].include,function(e){_.contains(t,e)||t.push(e)});return i.push("BasicExpression"),{start:"Start",expressions:o}}function s(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];var s=i.apply(this,e);return new t.Grammar(s.start,s.expressions)}e.Expressions=i,e.ExpressionsGrammar=s}(t.Grammars||(t.Grammars={}))}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){!function(e){e.notWordStart=" ()[],$@'\"",e.notInWord=" ()[],:",e.Basic={basicExpressions:["Word","DoubleQuoted"],grammars:{DoubleQuoted:'"[NotDoubleQuote]"',NotDoubleQuote:/[^"]*/,SingleQuoted:"'[NotSingleQuote]'",NotSingleQuote:/[^']*/,Number:/[0-9]+/,Word:function(n,i,s){var o=new RegExp("[^"+e.notWordStart.replace(/(.)/g,"\\$1")+"][^"+e.notInWord.replace(/(.)/g,"\\$1")+"]*"),r=n.match(o);null!=r&&0!=r.index&&(r=null);var u=new t.Result(null!=r?r[0]:null,s,n);return u.isSuccess()&&i&&n.length>u.value.length?new t.EndOfInputResult(u):u}}}}(t.Grammars||(t.Grammars={}))}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){!function(t){t.SubExpression={basicExpressions:["SubExpression"],grammars:{SubExpression:"([Expressions])"}}}(t.Grammars||(t.Grammars={}))}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){!function(t){t.Date={grammars:{Date:"[DateYear]/[DateMonth]/[DateDay]",DateYear:/([0-9]{4})/,DateMonth:/(1[0-2]|0?[1-9])/,DateDay:/([1-2][0-9]|3[0-1]|0?[1-9])/,DateRange:"[Date][Spaces?]..[Spaces?][Date]",DateRelative:["DateRelativeNegative","DateRelativeTerm"],DateRelativeTerm:/now|today|yesterday/,DateRelativeNegative:"[DateRelativeTerm][DateRelativeNegativeRef]",DateRelativeNegativeRef:/([\-\+][0-9]+(s|m|h|d|mo|y))/},include:[t.Basic]}}(t.Grammars||(t.Grammars={}))}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){!function(t){t.Field={basicExpressions:["FieldSimpleQuery","FieldQuery","Field"],grammars:{FieldQuery:"[Field][OptionalSpaces][FieldQueryOperation]",FieldQueryOperation:["FieldQueryValue","FieldQueryNumeric"],FieldQueryValue:"[FieldOperator][OptionalSpaces][FieldValue]",FieldQueryNumeric:"[FieldOperatorNumeric][OptionalSpaces][FieldValueNumeric]",FieldSimpleQuery:"[FieldName]:[OptionalSpaces][FieldValue]",Field:"@[FieldName]",FieldName:/[a-zA-Z][a-zA-Z0-9\.\_]*/,FieldOperator:/==|=|<>/,FieldOperatorNumeric:/<=|>=|<|>/,FieldValue:["DateRange","NumberRange","DateRelative","Date","Number","FieldValueList","FieldValueString"],FieldValueNumeric:["DateRelative","Date","Number"],FieldValueString:["DoubleQuoted","FieldValueNotQuoted"],FieldValueList:"([FieldValueString][FieldValueStringList*])",FieldValueStringList:"[FieldValueSeparator][FieldValueString]",FieldValueSeparator:/ *, */,FieldValueNotQuoted:/[^ \(\),]+/,NumberRange:"[Number][Spaces?]..[Spaces?][Number]"},include:[t.Date,t.Basic]}}(t.Grammars||(t.Grammars={}))}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){!function(t){t.QueryExtension={basicExpressions:["QueryExtension"],grammars:{QueryExtension:"$[QueryExtensionName]([QueryExtensionArguments])",QueryExtensionName:/\w+/,QueryExtensionArguments:"[QueryExtensionArgumentList*][QueryExtensionArgument]",QueryExtensionArgumentList:"[QueryExtensionArgument][Spaces?],[Spaces?]",QueryExtensionArgument:"[QueryExtensionArgumentName]:[Spaces?][QueryExtensionArgumentValue]",QueryExtensionArgumentName:/\w+/,QueryExtensionArgumentValue:["SingleQuoted","Expressions"]},include:[t.Basic]}}(t.Grammars||(t.Grammars={}))}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){!function(t){t.NestedQuery={basicExpressions:["NestedQuery"],grammars:{NestedQuery:"[[NestedField][OptionalSpaces][Expressions]]",NestedField:"[[Field]]",FieldValue:["NestedQuery"]},include:[t.Field]}}(t.Grammars||(t.Grammars={}))}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){!function(t){t.Complete={include:[t.NestedQuery,t.QueryExtension,t.SubExpression,t.Field,t.Basic]}}(t.Grammars||(t.Grammars={}))}(t.MagicBox||(t.MagicBox={}))}(n||(n={}));var n;!function(t){!function(t){function e(t,e,n){return new i(t,e,n)}function n(t){return"requestAnimationFrame"in window?window.requestAnimationFrame(t):setTimeout(t)}var i=function(){function e(e,n,i){var s=this;void 0===i&&(i={}),this.element=e,this.grammar=n,this.options=i,this.lastSuggestions=[],_.isUndefined(this.options.inline)&&(this.options.inline=!1),t.$$(e).addClass("magic-box"),this.options.inline&&t.$$(e).addClass("magic-box-inline"),this.result=this.grammar.parse(""),this.displayedResult=this.result.clean(),this.clearDom=document.createElement("div"),this.clearDom.className="magic-box-clear";var o=document.createElement("div");o.className="magic-box-icon",this.clearDom.appendChild(o);var r=t.$$(e).find(".magic-box-input");r?e.insertBefore(this.clearDom,r):(r=document.createElement("div"),r.className="magic-box-input",e.appendChild(this.clearDom),e.appendChild(r)),this.inputManager=new t.InputManager(r,function(t,e){e?(s.setText(t),s.onselect&&s.onselect(s.getFirstSuggestionText())):(s.setText(t),s.showSuggestion(),s.onchange&&s.onchange())},this),this.inputManager.ontabpress=function(){s.ontabpress&&s.ontabpress()};var u=this.inputManager.getValue();u&&(this.displayedResult.input=u),this.inputManager.setResult(this.displayedResult);var a=document.createElement("div");a.className="magic-box-suggestions",this.element.appendChild(a),this.suggestionsManager=new t.SuggestionsManager(a,{selectableClass:this.options.selectableSuggestionClass,selectedClass:this.options.selectedSuggestionClass,timeout:this.options.suggestionTimeout}),this.setupHandler()}return e.prototype.getResult=function(){return this.result},e.prototype.getDisplayedResult=function(){return this.displayedResult},e.prototype.setText=function(e){t.$$(this.element).toggleClass("magic-box-notEmpty",e.length>0),this.result=this.grammar.parse(e),this.displayedResult=this.result.clean(),this.inputManager.setResult(this.displayedResult)},e.prototype.setCursor=function(t){this.inputManager.setCursor(t)},e.prototype.getCursor=function(){return this.inputManager.getCursor()},e.prototype.resultAtCursor=function(t){return this.displayedResult.resultAt(this.getCursor(),t)},e.prototype.setupHandler=function(){var e=this;this.inputManager.onblur=function(){t.$$(e.element).removeClass("magic-box-hasFocus"),e.onblur&&e.onblur(),e.options.inline||e.clearSuggestion()},this.inputManager.onfocus=function(){t.$$(e.element).addClass("magic-box-hasFocus"),e.showSuggestion(),e.onfocus&&e.onfocus()},this.inputManager.onkeydown=function(t){if(38==t||40==t)return!1;if(13==t){return null==e.suggestionsManager.select()&&e.onsubmit&&e.onsubmit(),!1}return 27==t&&(e.clearSuggestion(),e.blur()),!0},this.inputManager.onchangecursor=function(){e.showSuggestion()},this.inputManager.onkeyup=function(t){if(38==t)e.onmove&&e.onmove(),e.focusOnSuggestion(e.suggestionsManager.moveUp()),e.onchange&&e.onchange();else{if(40!=t)return!0;e.onmove&&e.onmove(),e.focusOnSuggestion(e.suggestionsManager.moveDown()),e.onchange&&e.onchange()}return!1},this.clearDom.onclick=function(){e.clear()}},e.prototype.showSuggestion=function(){var t=this;this.suggestionsManager.mergeSuggestions(null!=this.getSuggestions?this.getSuggestions():[],function(e){t.updateSuggestion(e)})},e.prototype.updateSuggestion=function(t){var e=this;this.lastSuggestions=t;var n=this.getFirstSuggestionText();this.inputManager.setWordCompletion(n&&n.text),this.onsuggestions&&this.onsuggestions(t),_.each(t,function(t){null==t.onSelect&&null!=t.text&&(t.onSelect=function(){e.setText(t.text),e.onselect&&e.onselect(t)})})},e.prototype.focus=function(){t.$$(this.element).addClass("magic-box-hasFocus"),this.inputManager.focus()},e.prototype.blur=function(){this.inputManager.blur()},e.prototype.clearSuggestion=function(){var t=this;this.suggestionsManager.mergeSuggestions([],function(e){t.updateSuggestion(e)}),this.inputManager.setWordCompletion(null)},e.prototype.focusOnSuggestion=function(t){null==t||null==t.text?(t=this.getFirstSuggestionText(),this.inputManager.setResult(this.displayedResult,t&&t.text)):this.inputManager.setResult(this.grammar.parse(t.text).clean(),t.text)},e.prototype.getFirstSuggestionText=function(){return _.find(this.lastSuggestions,function(t){return null!=t.text})},e.prototype.getText=function(){return this.inputManager.getValue()},e.prototype.getWordCompletion=function(){return this.inputManager.getWordCompletion()},e.prototype.clear=function(){this.setText(""),this.showSuggestion(),this.focus(),this.onclear&&this.onclear()},e.prototype.hasSuggestions=function(){return this.suggestionsManager.hasSuggestions},e}();t.Instance=i,t.create=e,t.requestAnimationFrame=n}(t.MagicBox||(t.MagicBox={}))}(n||(n={})),t.exports=n.MagicBox}).call(e,n(6))},431:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),s=function(){function t(t){this.options=t}return t.prototype.addParameters=function(t,e){this.options.enableWildcards&&(t.enableWildcards=!0),this.options.enableQuestionMarks&&(t.enableQuestionMarks=!0),this.options.enableLowercaseOperators&&(t.enableLowercaseOperators=!0),i.isEmpty(e)||(t.enableQuerySyntax=this.options.enableQuerySyntax,t.expression.add(e),this.options.enablePartialMatch&&(t.enablePartialMatch=this.options.enablePartialMatch,this.options.partialMatchKeywords&&(t.partialMatchKeywords=this.options.partialMatchKeywords),this.options.partialMatchThreshold&&(t.partialMatchThreshold=this.options.partialMatchThreshold)))},t}();e.QueryboxQueryParameters=s},490:function(t,e){},496:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=n(81),s=n(33),o=n(1),r=function(){function e(t){var e=this;this.omnibox=t,this.cache={},this.omnibox.bind.on(this.omnibox.element,s.OmniboxEvents.populateOmniboxSuggestions,function(t){t.suggestions.push(e.getSuggestion())})}return e.prototype.getSuggestion=function(){var t=this,e=this.getHash();if(null==e)return null;var n=this.hashToString(e);if(null!=this.cache[n])return this.hashValueToSuggestion(e,this.cache[n]);var i;return"FieldName"==e.type&&(i=this.fieldNames(e.current)),"FieldValue"==e.type&&(i=this.fieldValues(e.field,e.current)),"SimpleFieldName"==e.type&&(i=this.simpleFieldNames(e.current)),this.cache[n]=i,i.catch(function(){delete t.cache[n]}),this.hashValueToSuggestion(e,i)},e.prototype.getHash=function(){var t=o.last(this.omnibox.resultAtCursor("FieldName"));if(null!=t){t=t.findParent("Field")||t;var e=t.toString(),n=t.before(),i=t.after();return{type:"FieldName",current:e,before:n,after:i}}var s=o.last(this.omnibox.resultAtCursor("FieldValue"));if(s){var r=s.findParent("FieldQuery")||this.omnibox.options.enableSimpleFieldAddon&&s.findParent("FieldSimpleQuery");if(r){var u=r.find("FieldName").toString();this.omnibox.options.fieldAlias&&u in this.omnibox.options.fieldAlias&&(u=this.omnibox.options.fieldAlias[u]);var a=s.toString(),n=s.before(),i=s.after();return{type:"FieldValue",field:u,current:a,before:n,after:i}}}if(this.omnibox.options.enableSimpleFieldAddon){var l=o.last(this.omnibox.resultAtCursor("Word"));if(null!=l){var e=l.toString(),n=l.before(),i=l.after();return{type:"SimpleFieldName",current:e,before:n,after:i}}}},e.prototype.hashToString=function(t){return null==t?null:t.type+t.current+(t.field||"")},e.prototype.hashValueToSuggestion=function(t,n){return n.then(function(n){return o.map(n,function(s,o){return{text:t.before+(0==t.current.toLowerCase().indexOf(s.toLowerCase())?t.current+s.substr(t.current.length):s)+t.after,html:i.MagicBox.Utils.highlightText(s,t.current,!0),index:e.INDEX-o/n.length}})})},e.prototype.getFields=function(){var e=this;return null==this.fields&&(this.fields=new t(function(t,n){if(null!=e.omnibox.options.listOfFields)t(e.omnibox.options.listOfFields);else{e.omnibox.queryController.getEndpoint().listFields().then(function(e){var n=o.chain(e).filter(function(t){return t.includeInQuery&&t.groupByField}).map(function(t){return t.name.substr(1)}).value();t(n)}).catch(function(){n()})}})),this.fields},e.prototype.fieldNames=function(t){var e=t.length>0&&"@"==t[0],n=e?t.substr(1):t,i=n.toLowerCase();return this.getFields().then(function(n){var s=o.chain(n).map(function(t){return{index:t.toLowerCase().indexOf(i),field:e?t:"@"+t}}).filter(function(e){return-1!=e.index&&e.field.length>t.length}).sortBy("index").map(function(t){return t.field}).value();return s=o.first(s,5)})},e.prototype.fieldValues=function(t,e){return this.omnibox.queryController.getEndpoint().listFieldValues({pattern:".*"+e+".*",patternType:"RegularExpression",sortCriteria:"occurrences",field:"@"+t,maximumNumberOfValues:5}).then(function(t){return o.chain(t).map(function(t){return{index:t.value.toLowerCase().indexOf(e),value:t.value}}).filter(function(t){return t.value.length>e.length}).sortBy("index").map(function(t){return t.value.replace(/ /g,"Â ")}).value()})},e.prototype.simpleFieldNames=function(t){var e=t,n=e.toLowerCase();return this.getFields().then(function(e){var i=o.chain(e).map(function(t){return{index:t.toLowerCase().indexOf(n),field:t+":"}}).filter(function(e){return-1!=e.index&&e.field.length>t.length}).sortBy("index").map(function(t){return t.field}).value();return i=o.first(i,5)})},e}();r.INDEX=64,e.FieldAddon=r}).call(e,n(6))},497:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=n(33),s=n(3),o=n(5),r=n(1),u=function(){function e(t){var e=this;this.omnibox=t,this.omnibox.bind.on(this.omnibox.element,i.OmniboxEvents.populateOmniboxSuggestions,function(t){r.each(e.getSuggestion(),function(e){t.suggestions.push(e)})})}return e.prototype.getSuggestion=function(){var t=this.omnibox.magicBox.getText();if(0==t.length)return null;if(this.lastQuery==t)return this.lastSuggestions;this.lastQuery=t;var e=this.buildPopulateOmniboxEventArgs();return s.$$(this.omnibox.root).trigger(i.OmniboxEvents.populateOmnibox,e),this.lastSuggestions=this.rowsToSuggestions(e.rows)},e.prototype.getCurrentQueryExpression=function(){var t=this.omnibox.getCursor(),e=this.omnibox.getText(),n=e.length,i=t,s=t;for(" "==e[i]&&i--;i>0&&" "!=e[i];)i--;for(;s<n&&" "!=e[s];)s++;return e.substring(i,s)},e.prototype.getRegexToSearch=function(t){return null==t&&(t=this.omnibox.getText()),new RegExp(o.Utils.escapeRegexCharacter(t),"i")},e.prototype.getQueryExpressionBreakDown=function(){var t=this,e=[],n=this.omnibox.getText().split(" ");return r.each(n,function(n){e.push({word:n,regex:t.getRegexToSearch(n)})}),e},e.prototype.replace=function(t,e){this.omnibox.setText(this.omnibox.getText().replace(t,e))},e.prototype.clearCurrentExpression=function(){this.replace(this.getCurrentQueryExpression(),"")},e.prototype.insertAt=function(t,e){var n=this.omnibox.getText(),i=[n.slice(0,t),e,n.slice(t)].join("");this.omnibox.setText(i)},e.prototype.replaceCurrentExpression=function(t){this.replace(this.getCurrentQueryExpression(),t)},e.prototype.buildPopulateOmniboxEventArgs=function(){var t=this,e=this.getCurrentQueryExpression();return{rows:[],completeQueryExpression:{word:this.omnibox.getText(),regex:this.getRegexToSearch()},currentQueryExpression:{word:e,regex:this.getRegexToSearch(e)},allQueryExpressions:this.getQueryExpressionBreakDown(),cursorPosition:this.omnibox.getCursor(),clear:function(){t.omnibox.clear()},clearCurrentExpression:function(){t.clearCurrentExpression()},replace:function(e,n){t.replace(e,n)},replaceCurrentExpression:function(e){t.replaceCurrentExpression(e)},insertAt:function(e,n){t.insertAt(e,n)},closeOmnibox:function(){t.omnibox.magicBox.blur()}}},e.prototype.rowsToSuggestions=function(e){return r.map(e,function(e){return o.Utils.isNullOrUndefined(e.element)?o.Utils.isNullOrUndefined(e.deferred)?null:new t(function(t){e.deferred.then(function(e){t(null!=e.element?[{dom:e.element,index:e.zIndex}]:null)})}):new t(function(t){t([{dom:e.element,index:e.zIndex}])})})},e}();e.OldOmniboxAddon=u}).call(e,n(6))},498:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(33),s=n(81),o=n(1),r=function(){function t(t){var e=this;this.omnibox=t,this.cache={},this.omnibox.bind.on(this.omnibox.element,i.OmniboxEvents.populateOmniboxSuggestions,function(t){t.suggestions.push(e.getSuggestion())})}return t.prototype.getSuggestion=function(){var t=this,e=this.getHash(this.omnibox.magicBox);if(null==e)return null;var n=this.hashToString(e);if(null!=this.cache[n])return this.hashValueToSuggestion(e,this.cache[n]);var i="QueryExtensionName"==e.type?this.names(e.current):this.attributeNames(e.name,e.current,e.used);return this.cache[n]=i,i.catch(function(){delete t.cache[n]}),this.hashValueToSuggestion(e,i)},t.prototype.getHash=function(t){var e=o.last(t.resultAtCursor("QueryExtension"));if(null!=e){var n=e.findAll("QueryExtensionArgument"),i=o.last(t.resultAtCursor("QueryExtensionName"));if(null!=i)return{type:"QueryExtensionName",current:i.toString(),before:i.before(),after:i.after()};if(null!=(i=o.last(t.resultAtCursor("QueryExtensionArgumentName")))){var s=o.chain(n).map(function(t){var e=t.find("QueryExtensionArgumentName");return e&&e.toString()}).compact().value(),r=e.find("QueryExtensionName").toString();return{type:"QueryExtensionArgumentName",current:i.toString(),before:i.before(),after:i.after(),name:r,used:s}}}return null},t.prototype.hashToString=function(t){return null==t?null:[t.type,t.current,t.name||"",t.used?t.used.join():""].join()},t.prototype.hashValueToSuggestion=function(e,n){return n.then(function(n){return o.map(n,function(i,o){return{html:s.MagicBox.Utils.highlightText(i,e.current,!0),text:e.before+i+e.after,index:t.INDEX-o/n.length}})})},t.prototype.getExtensions=function(){return null==this.extensions&&(this.extensions=this.omnibox.queryController.getEndpoint().extensions()),this.extensions},t.prototype.names=function(t){var e=t.toLowerCase();return this.getExtensions().then(function(t){var n=o.chain(t).map(function(t){return{index:t.name.toLowerCase().indexOf(e),extension:t.name}}).filter(function(t){return-1!=t.index&&t.extension.length>e.length}).sortBy("index").pluck("extension").value();return n=o.first(n,5)})},t.prototype.attributeNames=function(t,e,n){return this.getExtensions().then(function(i){var s=o.find(i,function(e){return e.name==t});return null==s?[]:o.filter(o.difference(s.argumentNames,n),function(t){return 0==t.indexOf(e)})})},t.prototype.hash=function(){},t}();r.INDEX=62,e.QueryExtensionAddon=r},499:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),s=n(26),o=n(33),r=n(20),u=n(1),a=function(){function t(t){var e=this;this.omnibox=t,this.cache={},i.$$(this.omnibox.element).on(o.OmniboxEvents.populateOmniboxSuggestions,function(t,n){n.suggestions.push(e.getSuggestion())})}return t.suggestiontHtml=function(t){return t.highlighted.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,function(t,e,n,s){var o="";n&&(o="coveo-omnibox-hightlight"),s&&(o="coveo-omnibox-hightlight2");var r;return r=o?i.$$("span",{className:o}):i.$$("span"),r.text(e||n||s),r.el.outerHTML})},t.isPartialMatch=function(t){var e=r.StringUtils.match(t.highlighted,/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g),n=u.find(e,function(t){return null!=t[1]});return null==n||u.every(u.last(e,u.indexOf(e,n)-e.length),function(t){return null!=t[1]})},t.prototype.getSuggestion=function(){var t=this,e=this.omnibox.magicBox.getText();if(0==e.length)return null;if(null!=this.cache[e])return this.cache[e];var n=this.getQuerySuggest(e);return this.cache[e]=n,n.catch(function(){delete t.cache[e]}),this.cache[e]},t.prototype.getQuerySuggest=function(e){var n={q:e},i=String.locale,o=this.omnibox.getBindings().componentOptionsModel.get(s.ComponentOptionsModel.attributesEnum.searchHub),r=this.omnibox.getBindings().searchInterface.options.pipeline,a=this.omnibox.options.enableSearchAsYouType,l=this.omnibox.getBindings().queryController.getLastQuery().context;return i&&(n.language=i),o&&(n.searchHub=o),r&&(n.pipeline=r),l&&(n.context=l),n.enableWordCompletion=a,this.omnibox.queryController.getEndpoint().getQuerySuggest(n).then(function(e){var n=e.completions;return u.map(n,function(e,i){return{html:t.suggestiontHtml(e),text:e.expression,index:t.INDEX-i/n.length,partial:t.isPartialMatch(e),executableConfidence:e.executableConfidence}})})},t}();a.INDEX=60,e.QuerySuggestAddon=a},613:function(t,e){},81:function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=n(26);e.MagicBox=n(429);var o=n(8),r=n(9),u=n(11),a=n(66),l=n(18),c=n(13),p=n(12),h=n(33),g=n(3),d=n(7),f=n(13),m=n(2),y=n(97),x=n(496),v=n(498),b=n(499),S=n(497),C=n(431),E=n(84),A=n(5),O=n(21),Q=n(1),T=n(4);n(490);var B=function(t){function n(e,i,o){var p=t.call(this,e,n.ID,o)||this;p.element=e,p.options=i,p.partialQueries=[],p.lastSuggestions=[],p.movedOnce=!1,p.skipAutoSuggest=!1,p.options=r.ComponentOptions.initComponentOptions(e,n,i);var h=p.options.enableQuerySyntax;return p.options=Q.extend({},p.options,p.componentOptionsModel.get(s.ComponentOptionsModel.attributesEnum.searchBox)),p.options.enableQuerySuggestAddon&&new b.QuerySuggestAddon(p),new S.OldOmniboxAddon(p),p.createMagicBox(),p.bind.onRootElement(u.QueryEvents.buildingQuery,function(t){return p.handleBuildingQuery(t)}),p.bind.onRootElement(a.StandaloneSearchInterfaceEvents.beforeRedirect,function(){return p.handleBeforeRedirect()}),p.bind.onRootElement(u.QueryEvents.querySuccess,function(){return p.handleQuerySuccess()}),p.bind.onQueryState(l.MODEL_EVENTS.CHANGE_ONE,c.QUERY_STATE_ATTRIBUTES.Q,function(t){return p.handleQueryStateChanged(t)}),p.isAutoSuggestion()&&p.bind.onRootElement(u.QueryEvents.duringQuery,function(t){return p.handleDuringQuery(t)}),p.bind.onComponentOptions(l.MODEL_EVENTS.CHANGE_ONE,s.COMPONENT_OPTIONS_ATTRIBUTES.SEARCH_BOX,function(t){null!=t.value.enableQuerySyntax?p.options.enableQuerySyntax=t.value.enableQuerySyntax:p.options.enableQuerySyntax=h,p.updateGrammar()}),p}return i(n,t),n.prototype.submit=function(){var t=this;this.magicBox.clearSuggestion(),this.updateQueryState(),this.triggerNewQuery(!1,function(){t.usageAnalytics.logSearchEvent(p.analyticsActionCauseList.searchboxSubmit,{})})},n.prototype.getText=function(){return this.magicBox.getText()},n.prototype.setText=function(t){this.magicBox.setText(t),this.updateQueryState()},n.prototype.clear=function(){this.magicBox.clear()},n.prototype.getInput=function(){return this.magicBox.element.querySelector("input")},n.prototype.getResult=function(){return this.magicBox.getResult()},n.prototype.getDisplayedResult=function(){return this.magicBox.getDisplayedResult()},n.prototype.getCursor=function(){return this.magicBox.getCursor()},n.prototype.resultAtCursor=function(t){return this.magicBox.resultAtCursor(t)},n.prototype.createGrammar=function(){var t=null;return this.options.enableQuerySyntax?(t=e.MagicBox.Grammars.Expressions(e.MagicBox.Grammars.Complete),this.options.enableFieldAddon&&new x.FieldAddon(this),null!=this.options.fieldAlias&&(this.options.listOfFields=this.options.listOfFields||[],this.options.listOfFields=this.options.listOfFields.concat(Q.keys(this.options.fieldAlias))),this.options.enableQueryExtensionAddon&&new v.QueryExtensionAddon(this)):t={start:"Any",expressions:{Any:/.*/}},null!=this.options.grammar&&(t=this.options.grammar(t)),t},n.prototype.updateGrammar=function(){var t=this.createGrammar();this.magicBox.grammar=new e.MagicBox.Grammar(t.start,t.expressions),this.magicBox.setText(this.magicBox.getText())},n.prototype.createMagicBox=function(){var t=this.createGrammar();this.magicBox=e.MagicBox.create(this.element,new e.MagicBox.Grammar(t.start,t.expressions),{inline:this.options.inline,selectableSuggestionClass:"coveo-omnibox-selectable",selectedSuggestionClass:"coveo-omnibox-selected",suggestionTimeout:this.options.omniboxTimeout}),this.setupMagicBox()},n.prototype.setupMagicBox=function(){var t=this;this.magicBox.onmove=function(){t.isAutoSuggestion()&&(t.modifyEventTo=t.getOmniboxAnalyticsEventCause()),t.movedOnce=!0},this.magicBox.onfocus=function(){t.isAutoSuggestion()&&(t.skipAutoSuggest=!0)},this.magicBox.onsuggestions=function(e){A.Utils.isEmptyString(t.getText())&&(t.partialQueries=[]),t.movedOnce=!1,t.lastSuggestions=e,t.isAutoSuggestion()&&!t.skipAutoSuggest&&t.searchAsYouType()},this.options.enableSearchAsYouType&&g.$$(this.element).addClass("coveo-magicbox-search-as-you-type"),this.magicBox.onchange=function(){t.skipAutoSuggest=!1;var e=t.getText();void 0!=e&&""!=e?t.isAutoSuggestion()?t.movedOnce&&t.searchAsYouType(!0):t.options.enableSearchAsYouType&&t.searchAsYouType(!0):t.clear()},this.options.placeholder&&(this.magicBox.element.querySelector("input").placeholder=this.options.placeholder),this.magicBox.onsubmit=function(){t.magicBox.clearSuggestion(),t.updateQueryState(),t.triggerNewQuery(!1,function(){t.usageAnalytics.logSearchEvent(p.analyticsActionCauseList.searchboxSubmit,{})}),t.magicBox.blur()},this.magicBox.onselect=function(e){var n=Q.indexOf(t.lastSuggestions,e),i=Q.compact(Q.map(t.lastSuggestions,function(t){return t.text}));t.magicBox.clearSuggestion(),t.updateQueryState(),t.isAutoSuggestion()?t.isAutoSuggestion()&&t.movedOnce?t.handleAutoSuggestionWithKeyboard(n,i):t.isAutoSuggestion()&&!t.movedOnce&&t.handleAutoSuggestionsWithMouse(n,i):(t.usageAnalytics.cancelAllPendingEvents(),t.triggerNewQuery(!1,function(){t.usageAnalytics.logSearchEvent(t.getOmniboxAnalyticsEventCause(),t.buildCustomDataForPartialQueries(n,i))})),t.isAutoSuggestion()&&(t.partialQueries=[])},this.magicBox.onblur=function(){t.options.enableSearchAsYouType&&!t.options.inline?t.setText(t.lastQuery):t.updateQueryState(),t.isAutoSuggestion()&&t.usageAnalytics.sendAllPendingEvents()},this.magicBox.onclear=function(){t.updateQueryState(),t.options.triggerQueryOnClear&&t.triggerNewQuery(!1,function(){t.usageAnalytics.logSearchEvent(p.analyticsActionCauseList.searchboxClear,{})})},this.magicBox.ontabpress=function(){t.handleTabPress()},this.magicBox.getSuggestions=function(){return t.handleSuggestions()}},n.prototype.handleAutoSuggestionWithKeyboard=function(t,e){var n=this;this.searchAsYouTypeTimeout?(this.usageAnalytics.cancelAllPendingEvents(),clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0,this.triggerNewQuery(!1,function(){n.usageAnalytics.logSearchEvent(n.getOmniboxAnalyticsEventCause(),n.buildCustomDataForPartialQueries(t,e))})):(this.modifyEventTo=this.getOmniboxAnalyticsEventCause(),this.modifyCustomDataOnPending(t,e),this.usageAnalytics.sendAllPendingEvents())},n.prototype.handleAutoSuggestionsWithMouse=function(t,e){var n=this;this.searchAsYouTypeTimeout||0!=t?(this.clearSearchAsYouType(),this.usageAnalytics.cancelAllPendingEvents(),this.triggerNewQuery(!1,function(){n.usageAnalytics.logSearchEvent(n.getOmniboxAnalyticsEventCause(),n.buildCustomDataForPartialQueries(t,e))})):(this.modifyEventTo=this.getOmniboxAnalyticsEventCause(),this.modifyCustomDataOnPending(t,e),this.usageAnalytics.sendAllPendingEvents(),this.lastQuery!=this.getText()&&this.triggerNewQuery(!1,function(){n.usageAnalytics.logSearchEvent(n.getOmniboxAnalyticsEventCause(),n.buildCustomDataForPartialQueries(t,e))}))},n.prototype.modifyCustomDataOnPending=function(t,e){var n=this.usageAnalytics.getPendingSearchEvent();if(n instanceof E.PendingSearchAsYouTypeSearchEvent){var i=this.buildCustomDataForPartialQueries(t,e);Q.each(Q.keys(i),function(t){n.modifyCustomData(t,i[t])})}},n.prototype.buildCustomDataForPartialQueries=function(t,e){return{partialQueries:this.cleanCustomData(this.partialQueries),suggestionRanking:t,suggestions:this.cleanCustomData(e),partialQuery:Q.last(this.partialQueries)}},n.prototype.cleanCustomData=function(t,e){void 0===e&&(e=256),t=Q.compact(Q.filter(t,function(t,e,n){return 0===e||t!==n[e-1]})),t=Q.map(t,function(t){return t.replace(/;/g,"")});var n=[];return Q.reduceRight(t,function(t,i){var s=t+i.length;return s<=e&&n.push(i),s},0),t=n.reverse(),t.join(";").length>=256?this.cleanCustomData(t,e-10):t.join(";")},n.prototype.handleSuggestions=function(){var t={suggestions:[],omnibox:this};this.bind.trigger(this.element,h.OmniboxEvents.populateOmniboxSuggestions,t);var e=this.getText();return A.Utils.isNullOrEmptyString(e)||this.partialQueries.push(e),Q.compact(t.suggestions)},n.prototype.handleBeforeRedirect=function(){this.updateQueryState()},n.prototype.handleBuildingQuery=function(t){var e=this;d.Assert.exists(t),d.Assert.exists(t.queryBuilder),this.updateQueryState(),this.lastQuery=this.getQuery(t.searchAsYouType);var n=this.lastQuery==this.magicBox.getDisplayedResult().input?this.magicBox.getDisplayedResult().clone():this.magicBox.grammar.parse(this.lastQuery).clean(),i={result:n};if(this.options.enableQuerySyntax){var s=i.result.findAll("FieldValueNotQuoted");if(Q.each(s,function(t){return t.value='"'+t.value.replace(/"|\u00A0/g," ")+'"'}),this.options.fieldAlias){var o=i.result.findAll(function(t){return"FieldName"==t.expression.id&&t.isSuccess()});Q.each(o,function(t){var n=Q.find(Q.keys(e.options.fieldAlias),function(e){return e.toLowerCase()==t.value.toLowerCase()});null!=n&&(t.value=e.options.fieldAlias[n])})}}this.bind.trigger(this.element,h.OmniboxEvents.omniboxPreprocessResultForQuery,i);var r=i.result.toString();new C.QueryboxQueryParameters(this.options).addParameters(t.queryBuilder,r)},n.prototype.handleTabPress=function(){this.options.enableQuerySuggestAddon?this.handleTabPressForSuggestions():this.handleTabPressForOldOmniboxAddon()},n.prototype.handleTabPressForSuggestions=function(){if(!this.options.enableSearchAsYouType){var t=Q.compact(Q.map(this.lastSuggestions,function(t){return t.text}));this.usageAnalytics.logCustomEvent(this.getOmniboxAnalyticsEventCause(),this.buildCustomDataForPartialQueries(0,t),this.element)}},n.prototype.handleTabPressForOldOmniboxAddon=function(){if(this.lastSuggestions&&this.lastSuggestions[0]&&this.lastSuggestions[0].dom){var t=g.$$(this.lastSuggestions[0].dom).find(".coveo-omnibox-selected"),e=g.$$(this.lastSuggestions[0].dom).find(".coveo-omnibox-selectable");t?g.$$(t).trigger("tabSelect"):e&&g.$$(e).trigger("tabSelect")}},n.prototype.triggerNewQuery=function(t,e){clearTimeout(this.searchAsYouTypeTimeout);var n=this.getQuery(t);this.shouldExecuteQuery(t)&&(this.lastQuery=n,e(),this.queryController.executeQuery({searchAsYouType:t,logInActionsHistory:!0}))},n.prototype.getQuery=function(t){var e;if(t&&null==(e=this.magicBox.getWordCompletion())&&null!=this.lastSuggestions&&this.lastSuggestions.length>0){var n=Q.find(this.lastSuggestions,function(t){return null!=t.text});null!=n&&(e=n.text)}return e||this.magicBox.getText()},n.prototype.updateQueryState=function(){this.queryStateModel.set(f.QueryStateModel.attributesEnum.q,this.magicBox.getText())},n.prototype.handleQueryStateChanged=function(t){d.Assert.exists(t);var e=t.value;e!=this.magicBox.getText()&&this.magicBox.setText(e)},n.prototype.handleQuerySuccess=function(){this.isAutoSuggestion()||(this.partialQueries=[])},n.prototype.handleDuringQuery=function(t){var e=this;t.promise.then(function(){var n=e.usageAnalytics.getPendingSearchEvent();n instanceof E.PendingSearchAsYouTypeSearchEvent&&n.beforeResolve.then(function(n){t.promise.then(function(){e.modifyEventTo&&(n.modifyEventCause(e.modifyEventTo),e.modifyEventTo=null)})})})},n.prototype.searchAsYouType=function(t){var e=this;void 0===t&&(t=!1),this.clearSearchAsYouType(),this.shouldExecuteQuery(!0)&&(this.searchAsYouTypeTimeout=setTimeout(function(){if(e.suggestionShouldTriggerQuery()||t){var n=Q.map(e.lastSuggestions,function(t){return t.text}),i=Q.indexOf(n,e.magicBox.getWordCompletion());e.triggerNewQuery(!0,function(){e.usageAnalytics.logSearchAsYouType(p.analyticsActionCauseList.searchboxAsYouType,e.buildCustomDataForPartialQueries(i,n))}),e.clearSearchAsYouType()}},this.options.searchAsYouTypeDelay))},n.prototype.isAutoSuggestion=function(){return this.options.enableSearchAsYouType&&this.options.enableQuerySuggestAddon},n.prototype.shouldExecuteQuery=function(t){var e=this.getQuery(t);return this.lastQuery!=e&&null!=e},n.prototype.suggestionShouldTriggerQuery=function(t){if(void 0===t&&(t=this.lastSuggestions),this.shouldExecuteQuery(!0)&&t&&t[0]){var e=t[0];if(e&&void 0!=e.executableConfidence)return e.executableConfidence>=.8;if(e.text&&0==e.text.indexOf(this.magicBox.getText()))return!0}return!1},n.prototype.clearSearchAsYouType=function(){clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0},n.prototype.getOmniboxAnalyticsEventCause=function(){return this.searchInterface instanceof O.StandaloneSearchInterface?p.analyticsActionCauseList.omniboxFromLink:p.analyticsActionCauseList.omniboxAnalytics},n}(o.Component);B.ID="Omnibox",B.doExport=function(){T.exportGlobally({Omnibox:B,MagicBox:e.MagicBox})},B.options={inline:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableSearchAsYouType:r.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:r.ComponentOptions.buildNumberOption({defaultValue:2e3,min:0,depend:"enableSearchAsYouType"}),enableFieldAddon:r.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableQuerySyntax",postProcessing:function(t,e){return t&&(e.enableQuerySyntax=!0),t}}),enableSimpleFieldAddon:r.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableFieldAddon"}),listOfFields:r.ComponentOptions.buildFieldsOption({depend:"enableFieldAddon"}),enableQuerySuggestAddon:r.ComponentOptions.buildBooleanOption({defaultValue:!0,alias:["enableTopQueryAddon","enableRevealQuerySuggestAddon"]}),enableQueryExtensionAddon:r.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableQuerySyntax",postProcessing:function(t,e){return t&&(e.enableQuerySyntax=!0),t}}),placeholder:r.ComponentOptions.buildLocalizedStringOption(),omniboxTimeout:r.ComponentOptions.buildNumberOption({defaultValue:2e3,min:0}),enableQuerySyntax:r.ComponentOptions.buildBooleanOption({defaultValue:!1})},e.Omnibox=B,B.options=Q.extend({},B.options,y.Querybox.options),m.Initialization.registerAutoCreateComponent(B)},97:function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=n(26);e.MagicBox=n(429);var o=n(2),r=n(8),u=n(9),a=n(11),l=n(18),c=n(13),p=n(66),h=n(12),g=n(3),d=n(7),f=n(431),m=n(1),y=n(4),x=function(t){function n(i,o,r){var d=t.call(this,i,n.ID,r)||this;return d.element=i,d.options=o,d.bindings=r,i instanceof HTMLInputElement&&d.logger.error("Querybox cannot be used on an HTMLInputElement"),d.options=u.ComponentOptions.initComponentOptions(i,n,o),d.options=m.extend({},d.options,d.componentOptionsModel.get(s.ComponentOptionsModel.attributesEnum.searchBox)),d.magicBox=e.MagicBox.create(i,new e.MagicBox.Grammar("Query",{Query:"[Term*][Spaces?]",Term:"[Spaces?][Word]",Spaces:/ +/,Word:/[^ ]+/}),{inline:!0}),d.bind.onRootElement(a.QueryEvents.buildingQuery,function(t){return d.handleBuildingQuery(t)}),d.bind.onRootElement(p.StandaloneSearchInterfaceEvents.beforeRedirect,function(){return d.updateQueryState()}),d.bind.onQueryState(l.MODEL_EVENTS.CHANGE_ONE,c.QUERY_STATE_ATTRIBUTES.Q,function(t){return d.handleQueryStateChanged(t)}),d.options.enableSearchAsYouType&&(g.$$(d.element).addClass("coveo-search-as-you-type"),d.magicBox.onchange=function(){d.searchAsYouType()}),d.magicBox.onsubmit=function(){d.submit()},d.magicBox.onblur=function(){d.updateQueryState()},d.magicBox.onclear=function(){d.updateQueryState(),d.options.triggerQueryOnClear&&(d.usageAnalytics.logSearchEvent(h.analyticsActionCauseList.searchboxClear,{}),d.triggerNewQuery(!1))},d}return i(n,t),n.prototype.submit=function(){this.magicBox.clearSuggestion(),this.updateQueryState(),this.usageAnalytics.logSearchEvent(h.analyticsActionCauseList.searchboxSubmit,{}),this.triggerNewQuery(!1)},n.prototype.setText=function(t){this.magicBox.setText(t),this.updateQueryState()},n.prototype.clear=function(){this.magicBox.clear()},n.prototype.getText=function(){return this.magicBox.getText()},n.prototype.getResult=function(){return this.magicBox.getResult()},n.prototype.getDisplayedResult=function(){return this.magicBox.getDisplayedResult()},n.prototype.getCursor=function(){return this.magicBox.getCursor()},n.prototype.resultAtCursor=function(t){return this.magicBox.resultAtCursor(t)},n.prototype.handleBuildingQuery=function(t){d.Assert.exists(t),d.Assert.exists(t.queryBuilder),this.updateQueryState(),this.lastQuery=this.magicBox.getText(),new f.QueryboxQueryParameters(this.options).addParameters(t.queryBuilder,this.lastQuery)},n.prototype.triggerNewQuery=function(t){clearTimeout(this.searchAsYouTypeTimeout);var e=this.magicBox.getText();this.lastQuery!=e&&null!=e&&(this.lastQuery=e,this.queryController.executeQuery({searchAsYouType:t,logInActionsHistory:!0}))},n.prototype.updateQueryState=function(){this.queryStateModel.set(c.QueryStateModel.attributesEnum.q,this.magicBox.getText())},n.prototype.handleQueryStateChanged=function(t){d.Assert.exists(t);var e=t.value;e!=this.magicBox.getText()&&this.magicBox.setText(e)},n.prototype.searchAsYouType=function(){var t=this;clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=setTimeout(function(){t.usageAnalytics.logSearchAsYouType(h.analyticsActionCauseList.searchboxAsYouType,{}),t.triggerNewQuery(!0)},this.options.searchAsYouTypeDelay)},n}(r.Component);x.ID="Querybox",x.doExport=function(){y.exportGlobally({Querybox:x,MagicBox:e.MagicBox})},x.options={enableSearchAsYouType:u.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:u.ComponentOptions.buildNumberOption({defaultValue:50,min:0}),enableQuerySyntax:u.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableWildcards:u.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:u.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:u.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableQuerySyntax"}),enablePartialMatch:u.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:u.ComponentOptions.buildNumberOption({defaultValue:5,min:1}),partialMatchThreshold:u.ComponentOptions.buildStringOption({defaultValue:"50%"}),triggerQueryOnClear:u.ComponentOptions.buildBooleanOption({defaultValue:!0})},e.Querybox=x,o.Initialization.registerAutoCreateComponent(x)}});