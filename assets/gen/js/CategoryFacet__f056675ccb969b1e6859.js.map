{"version":3,"sources":["./src/utils/SVGDom.ts","./src/ui/CategoryFacet/CategoryFacet.ts","./src/utils/EventsUtils.ts","./src/utils/AccessibleButton.ts","./src/rest/AllowedValuesPatternType.ts","./src/ui/Facet/FacetSearchElement.ts","./src/ui/CategoryFacet/CategoryValueChildrenRenderer.ts","./sass/_AccessibleButton.scss","./src/ui/Facet/FacetSearchUserInputHandler.ts","./src/ui/CategoryFacet/CategoryFacetTemplates.ts","./src/ui/CategoryFacet/CategoryValueRoot.ts","./src/ui/CategoryFacet/CategoryValue.ts","./src/controllers/CategoryFacetQueryController.ts","./sass/_CategoryFacet.scss","./src/ui/CategoryFacet/CategoryFacetSearch.ts","./sass/_CategoryFacetSearch.scss","./src/ui/CategoryFacet/CategoryFacetBreadcrumb.ts","./src/ui/CategoryFacet/CategoryFacetDebug.ts"],"names":[],"mappings":"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","file":"CategoryFacet__f056675ccb969b1e6859.js","sourcesContent":["import { IStringMap } from '../rest/GenericParam';\nimport * as _ from 'underscore';\n\nexport class SVGDom {\n  public static addClassToSVGInContainer(svgContainer: HTMLElement, classToAdd: string) {\n    const svgElement = svgContainer.querySelector('svg');\n    svgElement.setAttribute('class', `${SVGDom.getClass(svgElement)}${classToAdd}`);\n  }\n\n  public static removeClassFromSVGInContainer(svgContainer: HTMLElement, classToRemove: string) {\n    const svgElement = svgContainer.querySelector('svg');\n    svgElement.setAttribute('class', SVGDom.getClass(svgElement).replace(classToRemove, ''));\n  }\n\n  public static addStyleToSVGInContainer(svgContainer: HTMLElement, styleToAdd: IStringMap<any>) {\n    const svgElement = svgContainer.querySelector('svg');\n    _.each(styleToAdd, (styleValue, styleKey) => {\n      svgElement.style[styleKey] = styleValue;\n    });\n  }\n\n  private static getClass(svgElement: SVGElement) {\n    const className = svgElement.getAttribute('class');\n    return className ? className + ' ' : '';\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/SVGDom.ts","import { Component } from '../Base/Component';\nimport { l } from '../../strings/Strings';\nimport { IFieldOption, ComponentOptions } from '../Base/ComponentOptions';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { $$, Dom } from '../../utils/Dom';\nimport { Initialization } from '../Base/Initialization';\nimport { exportGlobally } from '../../GlobalExports';\nimport { CategoryFacetTemplates } from './CategoryFacetTemplates';\nimport { CategoryValueRoot } from './CategoryValueRoot';\nimport { CategoryFacetQueryController } from '../../controllers/CategoryFacetQueryController';\nimport { SVGDom } from '../../utils/SVGDom';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { QueryStateModel } from '../../models/QueryStateModel';\nimport 'styling/_CategoryFacet';\nimport { IAttributesChangedEventArg, MODEL_EVENTS } from '../../models/Model';\nimport { Utils } from '../../utils/Utils';\nimport { CategoryValue, CategoryValueParent } from './CategoryValue';\nimport { pluck, reduce, find, first, last, contains, isArray } from 'underscore';\nimport { Assert } from '../../misc/Assert';\nimport { QueryEvents, IBuildingQueryEventArgs, IQuerySuccessEventArgs } from '../../events/QueryEvents';\nimport { CategoryFacetSearch } from './CategoryFacetSearch';\nimport { KeyboardUtils, KEYBOARD } from '../../utils/KeyboardUtils';\nimport { ICategoryFacetResult } from '../../rest/CategoryFacetResult';\nimport { BreadcrumbEvents, IPopulateBreadcrumbEventArgs } from '../../events/BreadcrumbEvents';\nimport { CategoryFacetBreadcrumb } from './CategoryFacetBreadcrumb';\nimport { ICategoryFacetValue } from '../../rest/CategoryFacetValue';\nimport { ISearchEndpoint } from '../../rest/SearchEndpointInterface';\nimport { IAnalyticsCategoryFacetMeta, analyticsActionCauseList, IAnalyticsActionCause } from '../Analytics/AnalyticsActionListMeta';\nimport { CategoryFacetDebug } from './CategoryFacetDebug';\nimport { QueryBuilder } from '../Base/QueryBuilder';\nimport { IAutoLayoutAdjustableInsideFacetColumn } from '../SearchInterface/FacetColumnAutoLayoutAdjustment';\n\nexport interface ICategoryFacetOptions {\n  field: IFieldOption;\n  title?: string;\n  numberOfResultsInFacetSearch?: number;\n  id?: string;\n  enableFacetSearch?: boolean;\n  facetSearchDelay?: number;\n  numberOfValues?: number;\n  injectionDepth?: number;\n  enableMoreLess?: boolean;\n  pageSize?: number;\n  delimitingCharacter?: string;\n  debug?: boolean;\n  basePath?: string[];\n  maximumDepth?: number;\n}\n\nexport type CategoryValueDescriptor = {\n  value: string;\n  count: number;\n  path: string[];\n};\n\n/**\n * The `CategoryFacet` component is a facet that renders values in a hierarchical fashion. It determines the filter to apply depending on the\n * current selected path of values.\n *\n * The path is a sequence of values that leads to a specific value in the hierarchy.\n * It is an array listing all the parents of a file (e.g., `['c', 'folder1']` for the `c:\\folder1\\text1.txt` file).\n *\n * This facet requires a [`field`]{@link CategoryFacet.options.field} with a special format to work correctly (see [Using the Category Facet Component](https://docs.coveo.com/en/2667)).\n */\nexport class CategoryFacet extends Component implements IAutoLayoutAdjustableInsideFacetColumn {\n  static doExport = () => {\n    exportGlobally({\n      CategoryFacet\n    });\n  };\n\n  static ID = 'CategoryFacet';\n\n  /**\n   * The options for the component\n   * @componentOptions\n   */\n  static options: ICategoryFacetOptions = {\n    /**\n     * The index field whose values the facet should use. The field values should have the form:\n     * `the; the|path; the|path|to; the|path|to|given; the|path|to|given|item;`\n     * where the delimiting character is `|`. This default delimiting character can be changed using the [delimitingCharacter]{@link CategoryFacet.options.delimitingCharacter} option.\n     *\n     * To help you verify whether your fields are setup correctly, see the {@link CategoryFacet.options.debug} option\n     * and the {@link CategoryFacet.debugValue} method.\n     *\n     * See [Using the Category Facet Component](https://docs.coveo.com/en/2667).\n     */\n    field: ComponentOptions.buildFieldOption({ required: true }),\n    /**\n     * The title to display at the top of the facet.\n     *\n     * Default value is the localized string for `NoTitle`.\n     */\n    title: ComponentOptions.buildLocalizedStringOption({\n      defaultValue: l('NoTitle')\n    }),\n    /**\n     * The maximum number of field values to display by default in the facet before the user\n     * clicks the arrow to show more.\n     *\n     * See also the [`enableMoreLess`]{@link CategoryFacet.options.enableMoreLess} option.\n     */\n    numberOfValues: ComponentOptions.buildNumberOption({ defaultValue: 5, min: 0, section: 'CommonOptions' }),\n    /**\n     * Whether to display a search box at the bottom of the facet for searching among the available facet\n     * [`field`]{@link CategoryFacet.options.field} values.\n     *\n     * See also the [`facetSearchDelay`]{@link CategoryFacet.options.facetSearchDelay}, and\n     * [`numberOfResultsInFacetSearch`]{@link CategoryFacet.options.numberOfResultsInFacetSearch} options.\n     *\n     *\n     * Default value is `true`.\n     */\n    enableFacetSearch: ComponentOptions.buildBooleanOption({ defaultValue: true }),\n    /**\n     * A unique identifier for the facet. Among other things, this identifier serves the purpose of saving\n     * the facet state in the URL hash.\n     *\n     * If you have two facets with the same field on the same page, you should specify an `id` value for at least one of\n     * those two facets. This `id` must be unique among the facets.\n     *\n     * Default value is the [`field`]{@link CategoryFacet.options.field} option value.\n     */\n    id: ComponentOptions.buildStringOption({\n      postProcessing: (value, options: ICategoryFacetOptions) => value || (options.field as string)\n    }),\n    /**\n     * The *injection depth* to use.\n     *\n     * The injection depth determines how many results to scan in the index to ensure that the category facet lists all potential\n     * facet values. Increasing this value enhances the accuracy of the listed values at the cost of performance.\n     *\n     * Default value is `1000`. Minimum value is `0`.\n     * @notSupportedIn salesforcefree\n     */\n    injectionDepth: ComponentOptions.buildNumberOption({ defaultValue: 1000, min: 0 }),\n    /**\n     * If the [`enableFacetSearch`]{@link CategoryFacet.options.enableFacetSearch} option is `true`, specifies the number of\n     * values to display in the facet search results popup.\n     *\n     * Default value is `15`. Minimum value is `1`.\n     */\n    numberOfResultsInFacetSearch: ComponentOptions.buildNumberOption({ defaultValue: 15, min: 1 }),\n    /**\n     * If the [`enableFacetSearch`]{@link CategoryFacet.options.enableFacetSearch} option is `true`, specifies the delay (in\n     * milliseconds) before sending a search request to the server when the user starts typing in the category facet search box.\n     *\n     * Specifying a smaller value makes results appear faster. However, chances of having to cancel many requests\n     * sent to the server increase as the user keeps on typing new characters.\n     *\n     * Default value is `100`. Minimum value is `0`.\n     */\n    facetSearchDelay: ComponentOptions.buildNumberOption({ defaultValue: 100, min: 0 }),\n    /**\n     * Whether to enable the **More** and **Less** buttons in the Facet.\n     *\n     * See also the [`pageSize`]{@link CategoryFacet.options.pageSize} option.\n     *\n     * Default value is `true`.\n     */\n    enableMoreLess: ComponentOptions.buildBooleanOption({ defaultValue: true }),\n    /**\n     * If the [`enableMoreLess`]{@link CategoryFacet.options.enableMoreLess} option is `true`, specifies the number of\n     * additional results to fetch when clicking the **More** button.\n     *\n     * Default value is `10`. Minimum value is `1`.\n     */\n    pageSize: ComponentOptions.buildNumberOption({ defaultValue: 10, min: 1, depend: 'enableMoreLess' }),\n    /**\n     * The character that specifies the hierarchical dependency.\n     *\n     * **Example:**\n     *\n     * If your field has the following values:\n     *\n     * `@field: c; c>folder2; c>folder2>folder3;`\n     *\n     * The delimiting character is `>`.\n     *\n     * Default value is `|`.\n     */\n    delimitingCharacter: ComponentOptions.buildStringOption({ defaultValue: '|' }),\n    /**\n     * The path to use as the path prefix for every query.\n     *\n     * **Example:**\n     *\n     * You have the following files indexed on a file system:\n     * ```\n     * c:\\\n     *    folder1\\\n     *      text1.txt\n     *    folder2\\\n     *      folder3\\\n     *        text2.txt\n     * ```\n     * Setting the `basePath` to `c` would display `folder1` and `folder2` in the `CategoryFacet`, but omit `c`.\n     *\n     */\n    basePath: ComponentOptions.buildListOption<string>({ defaultValue: [] }),\n    /**\n     * The maximum number of levels to traverse in the hierarchy.\n     * This option does not count the length of the base path. The depth depends on what is shown in the interface.\n     *\n     * Default value is `Number.MAX_VALUE`.\n     */\n    maximumDepth: ComponentOptions.buildNumberOption({ min: 1, defaultValue: Number.MAX_VALUE }),\n    /**\n     * Whether to activate field format debugging.\n     * This options logs messages in the console for any potential encountered issues.\n     * This option can have negative effects on performance, and should only be activated when debugging.\n     */\n    debug: ComponentOptions.buildBooleanOption({ defaultValue: false })\n  };\n\n  public categoryFacetQueryController: CategoryFacetQueryController;\n  public listenToQueryStateChange = true;\n  public categoryFacetSearch: CategoryFacetSearch;\n  public activeCategoryValue: CategoryValue | undefined;\n  public positionInQuery: number;\n  public static MAXIMUM_NUMBER_OF_VALUES_BEFORE_TRUNCATING = 15;\n  public static NUMBER_OF_VALUES_TO_KEEP_AFTER_TRUNCATING = 10;\n\n  private categoryValueRoot: CategoryValueRoot;\n  private categoryFacetTemplates: CategoryFacetTemplates;\n  private facetHeader: Dom;\n  private waitElement: Dom;\n  private currentPage: number;\n  private moreLessContainer: Dom;\n  private moreValuesToFetch: boolean = true;\n  private numberOfChildValuesCurrentlyDisplayed = 0;\n  private numberOfValues: number;\n\n  public static WAIT_ELEMENT_CLASS = 'coveo-category-facet-header-wait-animation';\n\n  constructor(public element: HTMLElement, public options: ICategoryFacetOptions, bindings?: IComponentBindings) {\n    super(element, 'CategoryFacet', bindings);\n    this.options = ComponentOptions.initComponentOptions(element, CategoryFacet, options);\n\n    this.categoryFacetQueryController = new CategoryFacetQueryController(this);\n    this.categoryFacetTemplates = new CategoryFacetTemplates();\n    this.categoryValueRoot = new CategoryValueRoot($$(this.element), this.categoryFacetTemplates, this);\n    this.categoryValueRoot.path = this.activePath;\n    this.currentPage = 0;\n    this.numberOfValues = this.options.numberOfValues;\n\n    if (this.options.enableFacetSearch) {\n      this.categoryFacetSearch = new CategoryFacetSearch(this);\n    }\n\n    if (this.options.debug) {\n      new CategoryFacetDebug(this);\n    }\n\n    this.bind.onRootElement<IBuildingQueryEventArgs>(QueryEvents.buildingQuery, args => this.handleBuildingQuery(args));\n    this.bind.onRootElement<IQuerySuccessEventArgs>(QueryEvents.querySuccess, args => this.handleQuerySuccess(args));\n    this.bind.onRootElement(QueryEvents.duringQuery, () => this.addFading());\n    this.bind.onRootElement(QueryEvents.deferredQuerySuccess, () => this.removeFading());\n    this.bind.onRootElement<IPopulateBreadcrumbEventArgs>(BreadcrumbEvents.populateBreadcrumb, args => this.handlePopulateBreadCrumb(args));\n    this.bind.onRootElement(BreadcrumbEvents.clearBreadcrumb, () => this.handleClearBreadcrumb());\n    this.buildFacetHeader();\n    this.initQueryStateEvents();\n  }\n\n  public isCurrentlyDisplayed() {\n    return this.hasValues;\n  }\n\n  public get activePath() {\n    return this.queryStateModel.get(this.queryStateAttribute) || this.options.basePath;\n  }\n\n  public set activePath(newPath: string[]) {\n    this.listenToQueryStateChange = false;\n    this.queryStateModel.set(this.queryStateAttribute, newPath);\n    this.listenToQueryStateChange = true;\n  }\n\n  public get queryStateAttribute() {\n    return QueryStateModel.getFacetId(this.options.id);\n  }\n\n  public handleBuildingQuery(args: IBuildingQueryEventArgs) {\n    this.positionInQuery = this.categoryFacetQueryController.putCategoryFacetInQueryBuilder(\n      args.queryBuilder,\n      this.activePath,\n      this.numberOfValues + 1\n    );\n  }\n\n  private handleNoResults() {\n    if (this.isPristine()) {\n      this.hide();\n      return;\n    }\n\n    if (this.hasValues) {\n      this.show();\n      return;\n    }\n    this.activePath = this.options.basePath;\n    this.hide();\n  }\n\n  public handleQuerySuccess(args: IQuerySuccessEventArgs) {\n    if (Utils.isNullOrUndefined(args.results.categoryFacets)) {\n      this.notImplementedError();\n      return;\n    }\n\n    if (Utils.isNullOrUndefined(args.results.categoryFacets[this.positionInQuery])) {\n      this.handleNoResults();\n      return;\n    }\n\n    const numberOfRequestedValues = args.query.categoryFacets[this.positionInQuery].maximumNumberOfValues;\n    const categoryFacetResult = args.results.categoryFacets[this.positionInQuery];\n    this.moreValuesToFetch = numberOfRequestedValues == categoryFacetResult.values.length;\n    this.clear();\n\n    if (categoryFacetResult.notImplemented) {\n      this.notImplementedError();\n      return;\n    }\n\n    if (categoryFacetResult.values.length == 0 && categoryFacetResult.parentValues.length == 0) {\n      this.handleNoResults();\n      return;\n    }\n\n    this.renderValues(categoryFacetResult, numberOfRequestedValues);\n    if (this.options.enableFacetSearch) {\n      const facetSearch = this.categoryFacetSearch.build();\n      $$(facetSearch).insertAfter(this.categoryValueRoot.listRoot.el);\n    }\n\n    if (this.options.enableMoreLess) {\n      this.renderMoreLess();\n    }\n\n    if (!this.isPristine()) {\n      $$(this.element).addClass('coveo-category-facet-non-empty-path');\n    }\n  }\n\n  /**\n   * Changes the active path.\n   *\n   */\n  public changeActivePath(path: string[]) {\n    this.activePath = path;\n  }\n\n  public async executeQuery() {\n    this.showWaitingAnimation();\n    try {\n      await this.queryController.executeQuery();\n    } finally {\n      this.hideWaitAnimation();\n    }\n  }\n\n  /**\n   * Reloads the facet with the same path.\n   */\n  public reload() {\n    this.changeActivePath(this.activePath);\n    this.logAnalyticsEvent(analyticsActionCauseList.categoryFacetReload);\n    this.executeQuery();\n  }\n\n  /**\n   * Returns all the visible parent values.\n   * @returns simple object with three fields: `value`, `count` and `path`.\n   */\n  public getVisibleParentValues(): CategoryValueDescriptor[] {\n    return this.getVisibleParentCategoryValues().map(categoryValue => categoryValue.getDescriptor());\n  }\n\n  private getVisibleParentCategoryValues() {\n    if (this.categoryValueRoot.children.length == 0 || this.categoryValueRoot.children[0].children.length == 0) {\n      return [];\n    }\n    let currentParentvalue = this.categoryValueRoot.children[0];\n    const parentValues = [currentParentvalue];\n    while (currentParentvalue.children.length != 0 && !Utils.arrayEqual(currentParentvalue.path, this.activePath)) {\n      currentParentvalue = currentParentvalue.children[0];\n      parentValues.push(currentParentvalue);\n    }\n    return parentValues;\n  }\n\n  /**\n   * Shows more values according to {@link CategoryFacet.options.pageSize}.\n   *\n   * See the [`enableMoreLess`]{@link CategoryFacet.options.enableMoreLess}, and\n   * [`numberOfValues`]{@link CategoryFacet.options.numberOfValues} options.\n   */\n  public showMore() {\n    if (this.moreValuesToFetch) {\n      this.currentPage++;\n      this.numberOfValues = this.options.numberOfValues + this.currentPage * this.options.pageSize;\n      this.reload();\n    }\n  }\n\n  /**\n   * Shows less values, up to the original number of values.\n   *\n   * See the [`enableMoreLess`]{@link CategoryFacet.options.enableMoreLess}, and\n   * [`numberOfValues`]{@link CategoryFacet.options.numberOfValues} options.\n   */\n  public showLess() {\n    if (this.currentPage > 0) {\n      this.currentPage--;\n      this.numberOfValues = this.options.numberOfValues + this.currentPage * this.options.pageSize;\n      this.reload();\n    }\n  }\n\n  /**\n   * Returns the values at the bottom of the hierarchy. These are the values that are not yet applied to the query.\n   * @returns simple object with three fields: `value`, `count` and `path`.\n   */\n  public getAvailableValues() {\n    if (!this.activeCategoryValue) {\n      return [];\n    }\n    return this.activeCategoryValue.children.map(categoryValue => {\n      return {\n        value: categoryValue.categoryValueDescriptor.value,\n        count: categoryValue.categoryValueDescriptor.count,\n        path: categoryValue.path\n      };\n    });\n  }\n\n  /**\n   * Selects a value from the currently available values.\n   * If the given value to select is not in the available values, it will throw an error.\n   */\n  public selectValue(value: string) {\n    Assert.check(\n      contains(pluck(this.getAvailableValues(), 'value'), value),\n      'Failed while trying to select a value that is not available.'\n    );\n    const newPath = this.activePath.slice(0);\n    newPath.push(value);\n    this.changeActivePath(newPath);\n    this.logAnalyticsEvent(analyticsActionCauseList.categoryFacetSelect);\n    this.executeQuery();\n  }\n\n  /**\n   * Deselects the last value in the hierarchy that is applied to the query. When at the top of the hierarchy, this method does nothing.\n   */\n  public deselectCurrentValue() {\n    if (this.activePath.length == 0) {\n      return;\n    }\n\n    const newPath = this.activePath.slice(0);\n    newPath.pop();\n    this.changeActivePath(newPath);\n    this.logAnalyticsEvent(analyticsActionCauseList.categoryFacetSelect);\n    this.executeQuery();\n  }\n\n  /**\n   * Resets the facet to its initial state.\n   */\n  public reset() {\n    this.changeActivePath(this.options.basePath);\n    this.logAnalyticsEvent(analyticsActionCauseList.categoryFacetClear);\n    this.executeQuery();\n  }\n\n  public disable() {\n    super.disable();\n    this.hide();\n  }\n\n  /**\n   * Hides the component.\n   */\n  public hide() {\n    $$(this.element).addClass('coveo-hidden');\n  }\n\n  /**\n   * Shows the component.\n   */\n  public show() {\n    $$(this.element).removeClass('coveo-hidden');\n  }\n\n  /**\n   * Goes through any value that contains the value parameter, and verifies whether there are missing parents.\n   * Issues are then logged in the console.\n   * If you do not want to specify a value, you can simply enable {@link CategoryFacet.options.debug} and do an empty query.\n   */\n  public async debugValue(value: string) {\n    const queryBuilder = new QueryBuilder();\n    this.categoryFacetQueryController.addDebugGroupBy(queryBuilder, value);\n    const queryResults = await this.queryController.getEndpoint().search(queryBuilder.build());\n    CategoryFacetDebug.analyzeResults(queryResults.groupByResults[0], this.options.delimitingCharacter);\n  }\n\n  public showWaitingAnimation() {\n    if (this.waitElement.el.style.visibility == 'hidden') {\n      this.waitElement.el.style.visibility = 'visible';\n    }\n  }\n\n  public hideWaitAnimation() {\n    if (this.waitElement.el.style.visibility == 'visible') {\n      this.waitElement.el.style.visibility = 'hidden';\n    }\n  }\n\n  public logAnalyticsEvent(eventName: IAnalyticsActionCause, path = this.activePath) {\n    this.usageAnalytics.logSearchEvent<IAnalyticsCategoryFacetMeta>(eventName, {\n      categoryFacetId: this.options.id,\n      categoryFacetPath: path,\n      categoryFacetTitle: this.options.title\n    });\n  }\n\n  public getEndpoint(): ISearchEndpoint {\n    return this.queryController.getEndpoint();\n  }\n\n  get children(): CategoryValue[] {\n    return this.categoryValueRoot.children;\n  }\n\n  private renderValues(categoryFacetResult: ICategoryFacetResult, numberOfRequestedValues: number) {\n    this.show();\n    let sortedParentValues = this.sortParentValues(categoryFacetResult.parentValues);\n    let currentParentValue: CategoryValueParent = this.categoryValueRoot;\n    let needToTruncate = false;\n    let pathOfLastTruncatedParentValue: string[];\n\n    const numberOfItemsInFirstSlice = Math.floor(CategoryFacet.NUMBER_OF_VALUES_TO_KEEP_AFTER_TRUNCATING / 2);\n    const numberOfItemsInSecondSlice = Math.ceil(CategoryFacet.NUMBER_OF_VALUES_TO_KEEP_AFTER_TRUNCATING / 2);\n\n    sortedParentValues = this.hideBasePathInParentValues(sortedParentValues);\n\n    if (this.shouldTruncate(sortedParentValues)) {\n      pathOfLastTruncatedParentValue = this.findPathOfLastTruncatedParentValue(sortedParentValues, numberOfItemsInSecondSlice);\n      needToTruncate = true;\n      sortedParentValues = first(sortedParentValues, numberOfItemsInFirstSlice).concat(\n        last(sortedParentValues, numberOfItemsInSecondSlice)\n      );\n    }\n\n    if (!this.isPristine()) {\n      this.addAllCategoriesButton();\n    }\n\n    for (let i = 0; i < sortedParentValues.length; i++) {\n      currentParentValue = currentParentValue.renderAsParent(sortedParentValues[i]);\n\n      // We do not want to make the \"last\" parent selectable, as clicking it would be a noop (re-selecting the same filter)\n      const isLastParent = i == sortedParentValues.length - 1;\n      if (!isLastParent) {\n        (currentParentValue as CategoryValue).makeSelectable().showCollapseArrow();\n      }\n\n      if (needToTruncate) {\n        if (i == numberOfItemsInFirstSlice - 1) {\n          this.addEllipsis();\n        }\n\n        if (i == numberOfItemsInFirstSlice) {\n          currentParentValue.path = [...pathOfLastTruncatedParentValue, sortedParentValues[i].value];\n        }\n      }\n    }\n\n    const childrenValuesToRender = this.moreValuesToFetch\n      ? categoryFacetResult.values.slice(0, numberOfRequestedValues - 1)\n      : categoryFacetResult.values.slice(0, numberOfRequestedValues);\n\n    this.numberOfChildValuesCurrentlyDisplayed = childrenValuesToRender.length;\n\n    currentParentValue.renderChildren(childrenValuesToRender);\n    this.activeCategoryValue = currentParentValue as CategoryValue;\n  }\n\n  private hideBasePathInParentValues(parentValues: ICategoryFacetValue[]) {\n    if (Utils.arrayEqual(first(this.activePath, this.options.basePath.length), this.options.basePath)) {\n      parentValues = last(parentValues, parentValues.length - this.options.basePath.length);\n    }\n    return parentValues;\n  }\n\n  private shouldTruncate(parentValues: ICategoryFacetValue[]) {\n    return parentValues.length > CategoryFacet.MAXIMUM_NUMBER_OF_VALUES_BEFORE_TRUNCATING;\n  }\n\n  private addEllipsis() {\n    this.categoryValueRoot.listRoot.append(this.categoryFacetTemplates.buildEllipsis().el);\n  }\n\n  private findPathOfLastTruncatedParentValue(sortedParentValues: ICategoryFacetValue[], numberOfItemsInSecondSlice: number) {\n    const indexOfLastTruncatedParentValue = sortedParentValues.length - numberOfItemsInSecondSlice - 1;\n    return reduce(first(sortedParentValues, indexOfLastTruncatedParentValue + 1), (path, parentValue) => [...path, parentValue.value], []);\n  }\n\n  private addAllCategoriesButton() {\n    const allCategories = this.categoryFacetTemplates.buildAllCategoriesButton();\n    allCategories.on('click', () => this.reset());\n    this.categoryValueRoot.listRoot.append(allCategories.el);\n  }\n\n  private isPristine() {\n    return Utils.arrayEqual(this.activePath, this.options.basePath);\n  }\n\n  private buildFacetHeader() {\n    this.waitElement = $$('div', { className: CategoryFacet.WAIT_ELEMENT_CLASS }, SVGIcons.icons.loading);\n    SVGDom.addClassToSVGInContainer(this.waitElement.el, 'coveo-category-facet-header-wait-animation-svg');\n    this.waitElement.el.style.visibility = 'hidden';\n\n    const titleSection = $$('div', { className: 'coveo-category-facet-title' }, this.options.title);\n    this.facetHeader = $$('div', { className: 'coveo-category-facet-header' }, titleSection);\n    $$(this.element).prepend(this.facetHeader.el);\n    this.facetHeader.append(this.waitElement.el);\n\n    const clearIcon = $$(\n      'div',\n      { title: l('Clear', this.options.title), className: 'coveo-category-facet-header-eraser coveo-facet-header-eraser' },\n      SVGIcons.icons.mainClear\n    );\n    SVGDom.addClassToSVGInContainer(clearIcon.el, 'coveo-facet-header-eraser-svg');\n    clearIcon.on('click', () => {\n      this.logAnalyticsEvent(analyticsActionCauseList.categoryFacetClear);\n      this.reset();\n    });\n    this.facetHeader.append(clearIcon.el);\n  }\n\n  private handleQueryStateChanged(data: IAttributesChangedEventArg) {\n    if (this.listenToQueryStateChange) {\n      let path = data.attributes[this.queryStateAttribute];\n      if (!Utils.isNullOrUndefined(path) && isArray(path) && path.length != 0) {\n        this.activePath = path;\n      }\n    }\n  }\n\n  private initQueryStateEvents() {\n    this.queryStateModel.registerNewAttribute(this.queryStateAttribute, this.options.basePath);\n    this.bind.onQueryState<IAttributesChangedEventArg>(MODEL_EVENTS.CHANGE, undefined, data => this.handleQueryStateChanged(data));\n  }\n\n  private addFading() {\n    $$(this.element).addClass('coveo-category-facet-values-fade');\n  }\n\n  private removeFading() {\n    $$(this.element).removeClass('coveo-category-facet-values-fade');\n  }\n\n  private notImplementedError() {\n    const errorMessage = 'Category Facets are not supported by your current search endpoint. Disabling this component.';\n    this.logger.error(errorMessage);\n    this.disable();\n  }\n\n  private sortParentValues(parentValues: ICategoryFacetValue[]) {\n    if (this.activePath.length != parentValues.length) {\n      this.logger.warn('Inconsistent CategoryFacet results: Number of parent values results does not equal length of active path');\n      return parentValues;\n    }\n\n    const sortedParentvalues: ICategoryFacetValue[] = [];\n    for (const pathElement of this.activePath) {\n      const currentParentValue = find(parentValues, parentValue => parentValue.value.toLowerCase() == pathElement.toLowerCase());\n      if (!currentParentValue) {\n        this.logger.warn('Inconsistent CategoryFacet results: path not consistent with parent values results');\n        return parentValues;\n      }\n      sortedParentvalues.push(currentParentValue);\n    }\n    return sortedParentvalues;\n  }\n\n  private renderMoreLess() {\n    this.moreLessContainer = $$('div', { className: 'coveo-category-facet-more-less-container' });\n    $$(this.element).append(this.moreLessContainer.el);\n\n    if (this.numberOfChildValuesCurrentlyDisplayed > this.options.numberOfValues) {\n      this.moreLessContainer.append(this.buildLessButton());\n    }\n\n    if (this.moreValuesToFetch) {\n      this.moreLessContainer.append(this.buildMoreButton());\n    }\n  }\n\n  private clear() {\n    this.categoryValueRoot.clear();\n    if (this.options.enableFacetSearch) {\n      this.categoryFacetSearch.clear();\n    }\n    this.moreLessContainer && this.moreLessContainer.detach();\n    $$(this.element).removeClass('coveo-category-facet-non-empty-path');\n  }\n\n  private buildMoreButton() {\n    const svgContainer = $$('span', { className: 'coveo-facet-more-icon' }, SVGIcons.icons.arrowDown).el;\n    SVGDom.addClassToSVGInContainer(svgContainer, 'coveo-facet-more-icon-svg');\n    const more = $$('div', { className: 'coveo-category-facet-more', tabindex: 0 }, svgContainer);\n\n    const showMoreHandler = () => this.showMore();\n    more.on('click', () => this.showMore());\n    more.on('keyup', KeyboardUtils.keypressAction(KEYBOARD.ENTER, showMoreHandler));\n\n    return more.el;\n  }\n\n  private buildLessButton() {\n    const svgContainer = $$('span', { className: 'coveo-facet-less-icon' }, SVGIcons.icons.arrowUp).el;\n    SVGDom.addClassToSVGInContainer(svgContainer, 'coveo-facet-less-icon-svg');\n    const less = $$('div', { className: 'coveo-category-facet-less', tabIndex: 0 }, svgContainer);\n\n    const showLessHandler = () => this.showLess();\n    less.on('click', showLessHandler);\n    less.on('keyup', KeyboardUtils.keypressAction(KEYBOARD.ENTER, showLessHandler));\n\n    return less.el;\n  }\n\n  private handlePopulateBreadCrumb(args: IPopulateBreadcrumbEventArgs) {\n    const lastParentValue = this.getVisibleParentValues().pop();\n    if (!this.isPristine() && lastParentValue) {\n      const resetFacet = () => {\n        this.logAnalyticsEvent(analyticsActionCauseList.breadcrumbFacet);\n        this.reset();\n      };\n\n      const categoryFacetBreadcrumbBuilder = new CategoryFacetBreadcrumb(this.options.title, resetFacet, lastParentValue);\n      args.breadcrumbs.push({ element: categoryFacetBreadcrumbBuilder.build() });\n    }\n  }\n\n  private handleClearBreadcrumb() {\n    this.changeActivePath(this.options.basePath);\n  }\n\n  private get hasValues(): boolean {\n    return this.getAvailableValues().length > 0;\n  }\n}\n\nInitialization.registerAutoCreateComponent(CategoryFacet);\nCategoryFacet.doExport();\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/CategoryFacet/CategoryFacet.ts","import * as _ from 'underscore';\n\nexport class EventsUtils {\n  private static prefixes = ['webkit', 'moz', 'MS', 'o', ''];\n\n  // eventName must be in PascalCase\n  public static addPrefixedEvent(element: HTMLElement, pascalCaseEventName: string, callback) {\n    _.each(this.prefixes, prefix => {\n      if (prefix == '') {\n        pascalCaseEventName = pascalCaseEventName.toLowerCase();\n      }\n      element.addEventListener(prefix + pascalCaseEventName, callback, false);\n    });\n  }\n\n  // eventName must be in PascalCase\n  public static removePrefixedEvent(element: HTMLElement, pascalCaseEventName: string, callback) {\n    _.each(this.prefixes, prefix => {\n      if (prefix == '') {\n        pascalCaseEventName = pascalCaseEventName.toLowerCase();\n      }\n      element.removeEventListener(prefix + pascalCaseEventName, callback, false);\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/EventsUtils.ts","import { Logger } from '../misc/Logger';\nimport { ComponentEvents } from '../ui/Base/Component';\nimport { KEYBOARD, KeyboardUtils } from '../utils/KeyboardUtils';\nimport { $$, Dom } from './Dom';\nimport 'styling/_AccessibleButton';\n\nexport class AccessibleButton {\n  private element: Dom;\n  private label: string;\n  private title: string;\n\n  private clickAction: (e: Event) => void;\n  private enterKeyboardAction: (e: Event) => void;\n  private blurAction: (e: Event) => void;\n  private mouseleaveAction: (e: Event) => void;\n  private focusAction: (e: Event) => void;\n  private mouseenterAction: (e: Event) => void;\n\n  private logger: Logger;\n  private eventOwner: ComponentEvents;\n\n  public constructor() {\n    this.logger = new Logger(this);\n  }\n\n  public withOwner(owner: ComponentEvents) {\n    this.eventOwner = owner;\n    return this;\n  }\n\n  public withElement(element: Dom | HTMLElement) {\n    if (element instanceof HTMLElement) {\n      this.element = $$(element);\n    } else {\n      this.element = element;\n    }\n    return this;\n  }\n\n  public withLabel(label: string) {\n    this.label = label;\n    return this;\n  }\n\n  public withTitle(title: string) {\n    this.title = title;\n    return this;\n  }\n\n  public withSelectAction(action: (e: Event) => void) {\n    this.clickAction = action;\n    this.enterKeyboardAction = action;\n    return this;\n  }\n\n  public withClickAction(clickAction: (e: Event) => void) {\n    this.clickAction = clickAction;\n    return this;\n  }\n\n  public withEnterKeyboardAction(enterAction: (e: Event) => void) {\n    this.enterKeyboardAction = enterAction;\n    return this;\n  }\n\n  public withFocusAndMouseEnterAction(action: (e: Event) => void) {\n    this.focusAction = action;\n    this.mouseenterAction = action;\n    return this;\n  }\n\n  public withFocusAction(action: (e: Event) => void) {\n    this.focusAction = action;\n    return this;\n  }\n\n  public withMouseEnterAction(action: (e: Event) => void) {\n    this.mouseenterAction = action;\n    return this;\n  }\n\n  public withBlurAndMouseLeaveAction(action: (e: Event) => void) {\n    this.mouseleaveAction = action;\n    this.blurAction = action;\n    return this;\n  }\n\n  public withMouseLeaveAction(action: (e: Event) => void) {\n    this.mouseleaveAction = action;\n    return this;\n  }\n\n  public withBlurAction(action: (e: Event) => void) {\n    this.blurAction = action;\n    return this;\n  }\n\n  public build() {\n    if (!this.element) {\n      this.element = $$('div');\n    }\n\n    this.ensureCorrectRole();\n    this.ensureCorrectLabel();\n    this.ensureTitle();\n    this.ensureSelectAction();\n    this.ensureUnselectAction();\n    this.ensureMouseenterAndFocusAction();\n    this.ensureMouseleaveAndBlurAction();\n    this.ensureDifferentiationBetweenKeyboardAndMouseFocus();\n\n    return this;\n  }\n\n  private ensureDifferentiationBetweenKeyboardAndMouseFocus() {\n    const classOnPress = 'coveo-accessible-button-pressed';\n    const classOnFocus = 'coveo-accessible-button-focused';\n    $$(this.element).addClass('coveo-accessible-button');\n\n    $$(this.element).on('mousedown', () => {\n      $$(this.element).addClass(classOnPress);\n      $$(this.element).removeClass(classOnFocus);\n    });\n\n    $$(this.element).on('mouseup', () => $$(this.element).removeClass(classOnPress));\n    $$(this.element).on('focus', () => {\n      if (!$$(this.element).hasClass(classOnPress)) {\n        $$(this.element).addClass(classOnFocus);\n      }\n    });\n\n    $$(this.element).on('blur', () => $$(this.element).removeClass(classOnFocus));\n  }\n\n  private ensureCorrectRole() {\n    if (!this.element.getAttribute('role')) {\n      this.element.setAttribute('role', 'button');\n    }\n  }\n\n  private ensureCorrectLabel() {\n    if (!this.label) {\n      this.logger.error(`Missing label to create an accessible button !`);\n      return;\n    }\n    this.element.setAttribute('aria-label', this.label);\n  }\n\n  private ensureTitle() {\n    this.title && this.element.setAttribute('title', this.title);\n  }\n\n  private ensureTabIndex() {\n    this.element.setAttribute('tabindex', '0');\n  }\n\n  private ensureSelectAction() {\n    if (this.enterKeyboardAction) {\n      this.ensureTabIndex();\n      this.bindEvent('keyup', KeyboardUtils.keypressAction(KEYBOARD.ENTER, (e: Event) => this.enterKeyboardAction(e)));\n    }\n\n    if (this.clickAction) {\n      this.bindEvent('click', this.clickAction);\n    }\n  }\n\n  private ensureUnselectAction() {\n    if (this.blurAction) {\n      this.bindEvent('blur', this.blurAction);\n    }\n\n    if (this.mouseleaveAction) {\n      this.bindEvent('mouseleave', this.mouseleaveAction);\n    }\n  }\n\n  private ensureMouseenterAndFocusAction() {\n    if (this.mouseenterAction) {\n      this.bindEvent('mouseenter', this.mouseenterAction);\n    }\n    if (this.focusAction) {\n      this.bindEvent('focus', this.focusAction);\n    }\n  }\n\n  private ensureMouseleaveAndBlurAction() {\n    if (this.mouseleaveAction) {\n      this.bindEvent('mouseleave', this.mouseleaveAction);\n    }\n    if (this.blurAction) {\n      this.bindEvent('blur', this.blurAction);\n    }\n  }\n\n  private bindEvent(event: string, action: (...args: any[]) => void) {\n    if (this.eventOwner) {\n      this.eventOwner.on(this.element, event, action);\n    } else {\n      $$(this.element).on(event, action);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/AccessibleButton.ts","/**\n * The possible values for the [allowedValuesPatternType]{@link IGroupByRequest.allowedValuesPatternType} property of the `IGroupByRequest` interface.\n */\nexport enum AllowedValuesPatternType {\n  /**\n   * Only supports trailing wildcards in the pattern.\n   */\n  Legacy = 'legacy',\n  /**\n   * Fully supports wildcards.\n   */\n  Wildcards = 'wildcards',\n  /**\n   * Supports regular expression as the pattern.\n   */\n  Regex = 'regex',\n  /**\n   *Applies the Edit Distance algorithm to match values that are close to the specified pattern.\n   */\n  EditDistance = 'editdistance',\n  /**\n   *Applies a phonetic algorithm to match values that are phonetically similar to the specified pattern.\n   */\n  Phonetic = 'phonetic'\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/rest/AllowedValuesPatternType.ts","import { $$, Dom } from '../../utils/Dom';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { SVGDom } from '../../utils/SVGDom';\nimport { Component } from '../Base/Component';\nimport { l } from '../../strings/Strings';\nimport { EventsUtils } from '../../utils/EventsUtils';\nimport { PopupUtils, PopupHorizontalAlignment, PopupVerticalAlignment } from '../../utils/PopupUtils';\nimport { IFacetSearch } from './IFacetSearch';\nimport { FacetSearchUserInputHandler } from './FacetSearchUserInputHandler';\nimport { first, last } from 'underscore';\n\nexport class FacetSearchElement {\n  public search: HTMLElement | undefined;\n  public magnifier: HTMLElement | undefined;\n  public wait: HTMLElement | undefined;\n  public clear: HTMLElement | undefined;\n  public input: HTMLInputElement | undefined;\n  public searchBarIsAnimating: boolean = false;\n  public searchResults: HTMLElement;\n  public currentResult: Dom;\n  public facetSearchUserInputHandler: FacetSearchUserInputHandler;\n\n  private triggeredScroll = false;\n  private static FACET_SEARCH_PADDING = 40;\n\n  constructor(private facetSearch: IFacetSearch) {\n    this.facetSearchUserInputHandler = new FacetSearchUserInputHandler(this.facetSearch);\n    this.searchResults = $$('ul', { className: 'coveo-facet-search-results' }).el;\n    $$(this.searchResults).on('scroll', () => this.handleScrollEvent());\n    $$(this.searchResults).hide();\n  }\n\n  public build(handleFacetSearchClear?: () => void) {\n    this.search = document.createElement('div');\n    $$(this.search).addClass('coveo-facet-search');\n\n    this.magnifier = this.buildMagnifierIcon();\n    this.search.appendChild(this.magnifier);\n\n    this.wait = this.buildWaitIcon();\n    this.search.appendChild(this.wait);\n\n    this.hideFacetSearchWaitingAnimation();\n\n    this.clear = $$(\n      'div',\n      { className: 'coveo-facet-search-clear', title: l('Clear', l('Search')) },\n      SVGIcons.icons.checkboxHookExclusionMore\n    ).el;\n    SVGDom.addClassToSVGInContainer(this.clear, 'coveo-facet-search-clear-svg');\n    this.clear.style.display = 'none';\n    this.search.appendChild(this.clear);\n\n    const middle = document.createElement('div');\n    $$(middle).addClass('coveo-facet-search-middle');\n    this.search.appendChild(middle);\n\n    this.input = this.buildInputElement();\n    Component.pointElementsToDummyForm(this.input);\n    middle.appendChild(this.input);\n\n    $$(this.input).on('keyup', (e: KeyboardEvent) => {\n      this.facetSearchUserInputHandler.handleKeyboardEvent(e);\n    });\n    $$(this.clear).on('click', (e: Event) => {\n      handleFacetSearchClear && handleFacetSearchClear();\n    });\n    $$(this.input).on('focus', (e: Event) => {\n      this.handleFacetSearchFocus();\n    });\n\n    this.detectSearchBarAnimation();\n    return this.search;\n  }\n\n  public showFacetSearchWaitingAnimation() {\n    this.magnifier && $$(this.magnifier).hide();\n    $$(this.wait).show();\n  }\n\n  public getValueInInputForFacetSearch() {\n    return this.input.value.trim();\n  }\n\n  public hideFacetSearchWaitingAnimation() {\n    $$(this.magnifier).show();\n    $$(this.wait).hide();\n  }\n\n  public detectSearchBarAnimation() {\n    EventsUtils.addPrefixedEvent(this.search, 'AnimationStart', event => {\n      if (event.animationName == 'grow') {\n        this.searchBarIsAnimating = true;\n      }\n    });\n\n    EventsUtils.addPrefixedEvent(this.search, 'AnimationEnd', event => {\n      if (event.animationName == 'grow') {\n        this.searchBarIsAnimating = false;\n      }\n    });\n  }\n\n  public positionSearchResults(root: HTMLElement, facetWidth: number, nextTo: HTMLElement) {\n    if (this.searchResults != null) {\n      root.appendChild(this.searchResults);\n      this.searchResults.style.display = 'block';\n      this.searchResults.style.width = facetWidth - FacetSearchElement.FACET_SEARCH_PADDING + 'px';\n\n      if ($$(this.searchResults).css('display') == 'none') {\n        this.searchResults.style.display = '';\n      }\n      let searchBar = $$(this.search);\n      if (searchBar.css('display') == 'none' || this.searchBarIsAnimating) {\n        if ($$(this.searchResults).css('display') == 'none') {\n          this.searchResults.style.display = '';\n        }\n        EventsUtils.addPrefixedEvent(this.search, 'AnimationEnd', () => {\n          this.positionPopUp(nextTo, root);\n          EventsUtils.removePrefixedEvent(this.search, 'AnimationEnd', this);\n        });\n      } else {\n        this.positionPopUp(nextTo, root);\n      }\n    }\n  }\n\n  public setAsCurrentResult(toSet: Dom) {\n    this.currentResult && this.currentResult.removeClass('coveo-facet-search-current-result');\n    this.currentResult = toSet;\n    toSet.addClass('coveo-facet-search-current-result');\n  }\n\n  public moveCurrentResultDown() {\n    let nextResult = this.currentResult.el.nextElementSibling;\n    if (!nextResult) {\n      nextResult = first(this.searchResults.children);\n    }\n    this.setAsCurrentResult($$(<HTMLElement>nextResult));\n    this.highlightAndShowCurrentResultWithKeyboard();\n  }\n\n  public moveCurrentResultUp() {\n    let previousResult = this.currentResult.el.previousElementSibling;\n    if (!previousResult) {\n      previousResult = last(this.searchResults.children);\n    }\n    this.setAsCurrentResult($$(<HTMLElement>previousResult));\n    this.highlightAndShowCurrentResultWithKeyboard();\n  }\n\n  public highlightCurrentQueryInSearchResults(regex: RegExp) {\n    const captions = this.facetSearch.getCaptions();\n    captions.forEach(caption => {\n      caption.innerHTML = $$(caption)\n        .text()\n        .replace(regex, '<span class=\"coveo-highlight\">$1</span>');\n    });\n  }\n\n  public appendToSearchResults(el: HTMLElement) {\n    this.searchResults.appendChild(el);\n    this.setupFacetSearchResultsEvents(el);\n  }\n\n  public focus() {\n    this.input.focus();\n    this.handleFacetSearchFocus();\n  }\n\n  private highlightAndShowCurrentResultWithKeyboard() {\n    this.currentResult.addClass('coveo-facet-search-current-result');\n\n    this.triggeredScroll = true;\n    this.searchResults.scrollTop = this.currentResult.el.offsetTop;\n  }\n\n  private handleFacetSearchFocus() {\n    if (this.facetSearch.currentlyDisplayedResults == null) {\n      this.facetSearch.displayNewValues();\n    }\n  }\n\n  private setupFacetSearchResultsEvents(el: HTMLElement) {\n    $$(el).on('mousemove', () => {\n      this.setAsCurrentResult($$(el));\n    });\n\n    // Prevent closing the search results on the end of a touch drag\n    let touchDragging = false;\n    let mouseDragging = false;\n    $$(el).on('mousedown', () => (mouseDragging = false));\n    $$(el).on('mousemove', () => (mouseDragging = true));\n    $$(el).on('touchmove', () => (touchDragging = true));\n\n    $$(el).on('mouseup touchend', () => {\n      if (!touchDragging && !mouseDragging) {\n        setTimeout(() => {\n          this.facetSearch.dismissSearchResults();\n        }, 0); // setTimeout is to give time to trigger the click event before hiding the search menu.\n      }\n      touchDragging = false;\n      mouseDragging = false;\n    });\n  }\n\n  public hideSearchResultsElement() {\n    $$(this.searchResults).hide();\n    $$(this.searchResults).remove();\n  }\n\n  public clearSearchInput() {\n    if (this.input) {\n      this.input.value = '';\n    }\n  }\n\n  private buildMagnifierIcon() {\n    const magnifier = document.createElement('div');\n    magnifier.innerHTML = SVGIcons.icons.search;\n    $$(magnifier).addClass('coveo-facet-search-magnifier');\n    SVGDom.addClassToSVGInContainer(magnifier, 'coveo-facet-search-magnifier-svg');\n    this.search.appendChild(magnifier);\n    return magnifier;\n  }\n\n  private buildWaitIcon() {\n    const wait = document.createElement('div');\n    wait.innerHTML = SVGIcons.icons.loading;\n    $$(wait).addClass('coveo-facet-search-wait-animation');\n    SVGDom.addClassToSVGInContainer(wait, 'coveo-facet-search-wait-animation-svg');\n    return wait;\n  }\n\n  private buildInputElement() {\n    return <HTMLInputElement>$$('input', {\n      className: 'coveo-facet-search-input',\n      type: 'test',\n      autocapitalize: 'off',\n      autocorrect: 'off',\n      'aria-label': l('Search')\n    }).el;\n  }\n\n  private positionPopUp(nextTo: HTMLElement, root: HTMLElement) {\n    PopupUtils.positionPopup(this.searchResults, nextTo, root, {\n      horizontal: PopupHorizontalAlignment.CENTER,\n      vertical: PopupVerticalAlignment.BOTTOM\n    });\n  }\n\n  private handleScrollEvent() {\n    if (this.triggeredScroll) {\n      this.triggeredScroll = false;\n    } else {\n      this.facetSearchUserInputHandler.handleFacetSearchResultsScroll();\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Facet/FacetSearchElement.ts","import { Dom } from '../../utils/Dom';\nimport { CategoryFacetTemplates } from './CategoryFacetTemplates';\nimport { CategoryValue, CategoryValueParent } from './CategoryValue';\nimport { CategoryFacet } from './CategoryFacet';\nimport { ICategoryFacetValue } from '../../rest/CategoryFacetValue';\nimport { each } from 'underscore';\n\nexport class CategoryChildrenValueRenderer {\n  public children: CategoryValue[] = [];\n\n  constructor(\n    private element: Dom,\n    private categoryFacetTemplates: CategoryFacetTemplates,\n    private categoryValue: CategoryValueParent,\n    private categoryFacet: CategoryFacet\n  ) {}\n\n  public clearChildren() {\n    this.element.removeClass('coveo-active-category-facet-parent');\n    this.children.forEach(child => {\n      child.clear();\n    });\n    this.children = [];\n  }\n\n  public renderChildren(values: ICategoryFacetValue[]) {\n    each(values, value => {\n      this.renderValue(value, true).makeSelectable();\n    });\n  }\n\n  public renderAsParent(value: ICategoryFacetValue) {\n    const categoryValue = this.renderValue(value, false);\n    return categoryValue;\n  }\n\n  private renderValue(value: ICategoryFacetValue, isChild: boolean) {\n    const path = this.categoryValue.path.concat([value.value]);\n    const categoryValueDescriptor = {\n      value: value.value,\n      count: value.numberOfResults,\n      path\n    };\n    const categoryValue = new CategoryValue(\n      this.categoryValue.listRoot,\n      categoryValueDescriptor,\n      this.categoryFacetTemplates,\n      this.categoryFacet\n    );\n    categoryValue.render(isChild);\n    this.children.push(categoryValue);\n    return categoryValue;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/CategoryFacet/CategoryValueChildrenRenderer.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_AccessibleButton.scss\n// module id = 367\n// module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 13 15 16 18 19 20 22 23 24 25 26 28 29 30 31 37 38 39 40 41 42 78","import { IFacetSearch } from './IFacetSearch';\nimport { KEYBOARD } from '../../utils/KeyboardUtils';\nexport class FacetSearchUserInputHandler {\n  constructor(private facetSearch: IFacetSearch) {}\n\n  public handleKeyboardEvent(event: KeyboardEvent) {\n    switch (event.which) {\n      case KEYBOARD.ENTER:\n        this.facetSearch.keyboardNavigationEnterPressed(event);\n        break;\n      case KEYBOARD.DELETE:\n        this.facetSearch.keyboardNavigationDeletePressed && this.facetSearch.keyboardNavigationDeletePressed(event);\n        break;\n      case KEYBOARD.ESCAPE:\n        this.facetSearch.dismissSearchResults();\n        break;\n      case KEYBOARD.DOWN_ARROW:\n        this.facetSearch.facetSearchElement.moveCurrentResultDown();\n        break;\n      case KEYBOARD.UP_ARROW:\n        this.facetSearch.facetSearchElement.moveCurrentResultUp();\n        break;\n      default:\n        this.facetSearch.keyboardEventDefaultHandler();\n    }\n  }\n\n  public handleFacetSearchResultsScroll() {\n    if (\n      this.facetSearch.facetSearchPromise ||\n      this.facetSearch.facetSearchElement.getValueInInputForFacetSearch() != '' ||\n      !this.facetSearch.moreValuesToFetch\n    ) {\n      return;\n    }\n\n    let elementHeight = this.facetSearch.facetSearchElement.searchResults.clientHeight;\n    let scrollHeight = this.facetSearch.facetSearchElement.searchResults.scrollHeight;\n    let bottomPosition = this.facetSearch.facetSearchElement.searchResults.scrollTop + elementHeight;\n    if (scrollHeight - bottomPosition < elementHeight / 2) {\n      this.facetSearch.fetchMoreValues();\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/Facet/FacetSearchUserInputHandler.ts","import { $$, Dom } from '../../utils/Dom';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { SVGDom } from '../../utils/SVGDom';\nimport { escape } from 'underscore';\nimport { l } from '../../strings/Strings';\n\nexport interface CategoryFacetData {\n  value: string;\n  count: number;\n}\n\nexport class CategoryFacetTemplates {\n  private listRoot: Dom;\n  private collapseArrow: Dom;\n\n  constructor() {\n    this.listRoot = $$('ul', { className: 'coveo-category-facet-values' });\n    this.collapseArrow = $$('span', { className: 'coveo-category-facet-collapse-children' }, SVGIcons.icons.arrowDown);\n    SVGDom.addClassToSVGInContainer(this.collapseArrow.el, 'coveo-category-facet-collapse-children-svg');\n  }\n\n  public buildListRoot() {\n    return this.listRoot.clone(true);\n  }\n\n  public buildListElement(data: CategoryFacetData) {\n    const div = $$('div', {}, this.createListElement(data));\n    return $$(div.el.firstChild as HTMLElement);\n  }\n\n  public buildAllCategoriesButton() {\n    const allCategoriesCaption = $$('span', { className: 'coveo-category-facet-all-categories-caption' }, l('AllCategories'));\n    const allCategories = $$(\n      'li',\n      { className: 'coveo-category-facet-value coveo-category-facet-all-categories' },\n      this.buildCollapseArrow(),\n      allCategoriesCaption\n    );\n    return allCategories;\n  }\n\n  public buildEllipsis() {\n    const ellipsisCaption = $$('span', { className: 'coveo-category-facet-ellipsis-caption' }, '[ ... ]');\n    const ellipsis = $$('li', { className: 'coveo-category-facet-ellipsis' }, ellipsisCaption);\n    return ellipsis;\n  }\n\n  public buildCollapseArrow() {\n    return this.collapseArrow.clone(true);\n  }\n\n  private createListElement(data: CategoryFacetData) {\n    return `<li class=\"coveo-category-facet-value\">\n        <label class=\"coveo-category-facet-value-label\">\n          <span title=\"${escape(data.value)}\" class=\"coveo-category-facet-value-caption\">${escape(data.value)}</span>\n          <span class=\"coveo-category-facet-value-count\">${data.count}</span>\n        </label>\n      </li>`;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/CategoryFacet/CategoryFacetTemplates.ts","import { CategoryFacetTemplates } from './CategoryFacetTemplates';\nimport { Dom } from '../../utils/Dom';\nimport { CategoryChildrenValueRenderer } from './CategoryValueChildrenRenderer';\nimport { CategoryFacet } from './CategoryFacet';\nimport { ICategoryFacetValue } from '../../rest/CategoryFacetValue';\nimport { CategoryValueParent, CategoryValue } from './CategoryValue';\n\nexport class CategoryValueRoot implements CategoryValueParent {\n  public path = [];\n  public categoryChildrenValueRenderer: CategoryChildrenValueRenderer;\n  public listRoot: Dom;\n\n  constructor(private element: Dom, categoryFacetTemplates: CategoryFacetTemplates, categoryFacet: CategoryFacet) {\n    this.categoryChildrenValueRenderer = new CategoryChildrenValueRenderer(element, categoryFacetTemplates, this, categoryFacet);\n    this.listRoot = categoryFacetTemplates.buildListRoot();\n    this.appendListRoot();\n  }\n\n  public renderChildren(values: ICategoryFacetValue[]) {\n    this.appendListRoot();\n    this.categoryChildrenValueRenderer.renderChildren(values);\n  }\n\n  public renderAsParent(value: ICategoryFacetValue): CategoryValue {\n    this.appendListRoot();\n    return this.categoryChildrenValueRenderer.renderAsParent(value);\n  }\n\n  public get children(): CategoryValue[] {\n    return this.categoryChildrenValueRenderer.children;\n  }\n\n  public clear() {\n    this.listRoot.detach();\n    this.listRoot.empty();\n    this.categoryChildrenValueRenderer.clearChildren();\n  }\n\n  private appendListRoot() {\n    this.element.append(this.listRoot.el);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/CategoryFacet/CategoryValueRoot.ts","import { Dom, $$ } from '../../utils/Dom';\nimport { CategoryFacetTemplates } from './CategoryFacetTemplates';\nimport { CategoryChildrenValueRenderer } from './CategoryValueChildrenRenderer';\nimport { CategoryFacet, CategoryValueDescriptor } from './CategoryFacet';\nimport { ICategoryFacetValue } from '../../rest/CategoryFacetValue';\nimport { analyticsActionCauseList } from '../Analytics/AnalyticsActionListMeta';\nimport { AccessibleButton } from '../../utils/AccessibleButton';\nimport { l } from '../../strings/Strings';\n\nexport interface CategoryValueParent {\n  listRoot: Dom;\n  path: string[];\n  categoryChildrenValueRenderer: CategoryChildrenValueRenderer;\n  renderAsParent(categoryFacetValue: ICategoryFacetValue): CategoryValue;\n  renderChildren(categoryFacetValues: ICategoryFacetValue[]): void;\n}\n\nexport class CategoryValue implements CategoryValueParent {\n  private collapseArrow: Dom;\n  private label: Dom;\n\n  public path: string[];\n  public element: Dom;\n  public isActive = false;\n  public categoryChildrenValueRenderer: CategoryChildrenValueRenderer;\n\n  constructor(\n    public listRoot: Dom,\n    public categoryValueDescriptor: CategoryValueDescriptor,\n    private categoryFacetTemplates: CategoryFacetTemplates,\n    private categoryFacet: CategoryFacet\n  ) {\n    this.element = this.categoryFacetTemplates.buildListElement({\n      value: this.categoryValueDescriptor.value,\n      count: this.categoryValueDescriptor.count\n    });\n    this.collapseArrow = this.categoryFacetTemplates.buildCollapseArrow();\n    this.categoryChildrenValueRenderer = new CategoryChildrenValueRenderer(this.element, categoryFacetTemplates, this, this.categoryFacet);\n    this.path = this.categoryValueDescriptor.path;\n  }\n\n  public render(isChild: boolean) {\n    if (this.pastMaximumDepth()) {\n      this.element.addClass('coveo-category-facet-last-value');\n    }\n\n    if (isChild) {\n      this.element.addClass('coveo-category-facet-child-value');\n    } else {\n      this.element.addClass('coveo-category-facet-parent-value');\n    }\n\n    this.listRoot.append(this.element.el);\n  }\n\n  public getDescriptor() {\n    return {\n      value: this.categoryValueDescriptor.value,\n      count: this.categoryValueDescriptor.count,\n      path: this.path\n    };\n  }\n\n  public clear() {\n    this.element.detach();\n    this.categoryChildrenValueRenderer.clearChildren();\n  }\n\n  public renderChildren(values: ICategoryFacetValue[]) {\n    this.isActive = true;\n    this.element.addClass('coveo-active-category-facet-parent');\n    this.categoryChildrenValueRenderer.renderChildren(values);\n  }\n\n  public renderAsParent(value: ICategoryFacetValue) {\n    return this.categoryChildrenValueRenderer.renderAsParent(value);\n  }\n\n  public get children() {\n    return this.categoryChildrenValueRenderer.children;\n  }\n\n  public makeSelectable() {\n    this.label = $$(this.element.find('.coveo-category-facet-value-label'));\n    this.label.addClass('coveo-selectable');\n\n    new AccessibleButton()\n      .withElement(this.label)\n      .withSelectAction(() => this.onSelect())\n      .withLabel(`${l(this.categoryValueDescriptor.value)} ${this.categoryValueDescriptor.count}`)\n      .build();\n\n    return this;\n  }\n\n  public showCollapseArrow() {\n    if (!this.collapseArrow.el.parentElement) {\n      const label = this.element.find('label');\n      $$(label).prepend(this.collapseArrow.el);\n    }\n\n    return this;\n  }\n\n  private onSelect() {\n    if (!this.pastMaximumDepth()) {\n      this.categoryFacet.logAnalyticsEvent(analyticsActionCauseList.categoryFacetSelect, this.path);\n      this.categoryFacet.changeActivePath(this.path);\n      this.categoryFacet.executeQuery();\n    }\n  }\n\n  private pastMaximumDepth() {\n    return this.path.length - this.categoryFacet.options.basePath.length >= this.categoryFacet.options.maximumDepth;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/CategoryFacet/CategoryValue.ts","import { CategoryFacet } from '../ui/CategoryFacet/CategoryFacet';\nimport { QueryBuilder } from '../ui/Base/QueryBuilder';\nimport { ICategoryFacetRequest } from '../rest/CategoryFacetRequest';\nimport { IGroupByRequest } from '../rest/GroupByRequest';\nimport { AllowedValuesPatternType } from '../rest/AllowedValuesPatternType';\nimport { IGroupByValue } from '../rest/GroupByValue';\nimport { Utils } from '../utils/Utils';\n\nexport class CategoryFacetQueryController {\n  constructor(private categoryFacet: CategoryFacet) {}\n\n  public putCategoryFacetInQueryBuilder(queryBuilder: QueryBuilder, path: string[], maximumNumberOfValues: number): number {\n    const positionInQuery = queryBuilder.categoryFacets.length;\n    if (path.length != 0) {\n      queryBuilder.advancedExpression.addFieldExpression(this.categoryFacet.options.field as string, '==', [\n        path.join(this.categoryFacet.options.delimitingCharacter)\n      ]);\n    }\n    const categoryFacetsRequest: ICategoryFacetRequest = {\n      field: this.categoryFacet.options.field as string,\n      path,\n      injectionDepth: this.categoryFacet.options.injectionDepth,\n      maximumNumberOfValues,\n      delimitingCharacter: this.categoryFacet.options.delimitingCharacter\n    };\n    queryBuilder.categoryFacets.push(categoryFacetsRequest);\n    return positionInQuery;\n  }\n\n  public async searchFacetValues(value: string, numberOfValues: number): Promise<IGroupByValue[]> {\n    const lastQuery = { ...this.categoryFacet.queryController.getLastQuery() };\n\n    const groupByRequest: IGroupByRequest = {\n      allowedValues: [`*${value}*`],\n      allowedValuesPatternType: AllowedValuesPatternType.Wildcards,\n      maximumNumberOfValues: numberOfValues,\n      field: this.categoryFacet.options.field as string,\n      sortCriteria: 'occurrences',\n      injectionDepth: this.categoryFacet.options.injectionDepth\n    };\n\n    lastQuery.groupBy = [groupByRequest];\n    lastQuery.categoryFacets.splice(this.categoryFacet.positionInQuery, 1);\n    const results = await this.categoryFacet.queryController.getEndpoint().search(lastQuery);\n\n    const sortByNumberOfResultsThenPathLength = (firstGroupByValue: IGroupByValue, secondGroupByValue: IGroupByValue) => {\n      if (firstGroupByValue.numberOfResults == secondGroupByValue.numberOfResults) {\n        return firstGroupByValue.value.length - secondGroupByValue.value.length;\n      }\n      return secondGroupByValue.numberOfResults - firstGroupByValue.numberOfResults;\n    };\n\n    return results.groupByResults[0].values.sort(sortByNumberOfResultsThenPathLength);\n  }\n\n  public addDebugGroupBy(queryBuilder: QueryBuilder, value: string) {\n    queryBuilder.groupByRequests.push({\n      field: this.categoryFacet.options.field as string,\n      allowedValues: [`.*${Utils.escapeRegexCharacter(value)}.*`],\n      allowedValuesPatternType: AllowedValuesPatternType.Regex\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/controllers/CategoryFacetQueryController.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_CategoryFacet.scss\n// module id = 494\n// module chunks = 10 78","import { CategoryFacet } from './CategoryFacet';\nimport { FacetSearchElement } from '../Facet/FacetSearchElement';\nimport { pluck, debounce, last } from 'underscore';\nimport { $$, Dom } from '../../utils/Dom';\nimport { SVGDom } from '../../utils/SVGDom';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { l } from '../../strings/Strings';\nimport { IGroupByValue } from '../../rest/GroupByValue';\nimport 'styling/_CategoryFacetSearch';\nimport { StringUtils } from '../../utils/StringUtils';\nimport { analyticsActionCauseList, IAnalyticsCategoryFacetMeta } from '../Analytics/AnalyticsActionListMeta';\nimport { IFacetSearch } from '../Facet/IFacetSearch';\nimport { IIndexFieldValue } from '../../rest/FieldValue';\nimport { AccessibleButton } from '../../utils/AccessibleButton';\n\nexport class CategoryFacetSearch implements IFacetSearch {\n  public container: Dom | undefined;\n  public facetSearchElement: FacetSearchElement;\n  public displayNewValues: () => void;\n  public currentlyDisplayedResults: string[];\n  public moreValuesToFetch = true;\n  public facetSearchPromise: Promise<IIndexFieldValue[]>;\n\n  private numberOfValuesToFetch: number;\n\n  constructor(private categoryFacet: CategoryFacet) {\n    this.facetSearchElement = new FacetSearchElement(this);\n    this.displayNewValues = debounce(this.getDisplayNewValuesFunction(), this.categoryFacet.options.facetSearchDelay);\n    this.categoryFacet.root.addEventListener('click', (e: MouseEvent) => this.handleClickElsewhere(e));\n    this.numberOfValuesToFetch = this.categoryFacet.options.numberOfResultsInFacetSearch;\n  }\n\n  public build() {\n    this.container = $$('div', {\n      className: 'coveo-category-facet-search-container',\n      role: 'heading',\n      'aria-level': 3\n    });\n\n    new AccessibleButton()\n      .withElement(this.container)\n      .withSelectAction(() => {\n        $$(this.categoryFacet.element).addClass('coveo-category-facet-searching');\n        this.focus();\n      })\n      .withLabel(l('Search'))\n      .build();\n\n    const search = this.facetSearchElement.build();\n    const searchPlaceholder = this.buildfacetSearchPlaceholder();\n    this.container.append(search);\n    this.container.append(searchPlaceholder.el);\n    return this.container;\n  }\n\n  public focus() {\n    this.facetSearchElement.focus();\n  }\n\n  public clear() {\n    this.dismissSearchResults();\n    this.container && this.container.detach();\n  }\n\n  public dismissSearchResults() {\n    this.removeNoResultsCssClasses();\n    $$(this.categoryFacet.element).removeClass('coveo-category-facet-searching');\n    $$(this.facetSearchElement.searchResults).empty();\n    this.facetSearchElement.clearSearchInput();\n    this.facetSearchElement.hideSearchResultsElement();\n    this.currentlyDisplayedResults = null;\n    this.numberOfValuesToFetch = this.categoryFacet.options.numberOfResultsInFacetSearch;\n    this.moreValuesToFetch = true;\n  }\n\n  public keyboardEventDefaultHandler() {\n    this.moreValuesToFetch = true;\n    this.displayNewValues();\n  }\n\n  public keyboardNavigationEnterPressed() {\n    this.selectCurrentResult();\n  }\n\n  public fetchMoreValues() {\n    this.numberOfValuesToFetch += this.categoryFacet.options.numberOfResultsInFacetSearch;\n    this.displayNewValues();\n  }\n\n  public getCaptions() {\n    const searchResults = $$(this.facetSearchElement.searchResults);\n    const captions = searchResults\n      .findAll('.coveo-category-facet-search-value-caption')\n      .concat(searchResults.findAll('.coveo-category-facet-search-path-parents'))\n      .concat(searchResults.findAll('.coveo-category-facet-search-path-last-value'));\n    return captions;\n  }\n\n  private selectCurrentResult() {\n    if (this.facetSearchElement.currentResult) {\n      const currentResultPathData = this.facetSearchElement.currentResult.el.dataset.path;\n      const delimiter = this.categoryFacet.options.delimitingCharacter;\n      const path = currentResultPathData.split(delimiter);\n      this.categoryFacet.changeActivePath(path);\n      this.categoryFacet.logAnalyticsEvent(analyticsActionCauseList.categoryFacetSelect, path);\n      this.categoryFacet.executeQuery();\n    }\n  }\n\n  private handleClickElsewhere(e: MouseEvent) {\n    if (!$$(<HTMLElement>e.target).closest('.coveo-category-facet-search-container')) {\n      this.dismissSearchResults();\n    }\n  }\n\n  private buildfacetSearchPlaceholder() {\n    const placeholder = $$('div', { className: 'coveo-category-facet-search-placeholder' });\n\n    const icon = $$('div', { className: 'coveo-category-facet-search-icon' }, SVGIcons.icons.checkboxHookExclusionMore);\n    SVGDom.addClassToSVGInContainer(icon.el, 'coveo-category-facet-search-icon-svg');\n\n    const label = $$('span', { className: 'coveo-category-facet-search-label' }, l('Search'));\n\n    placeholder.append(icon.el);\n    placeholder.append(label.el);\n    return placeholder;\n  }\n\n  private getDisplayNewValuesFunction() {\n    return async () => {\n      this.facetSearchElement.showFacetSearchWaitingAnimation();\n      this.categoryFacet.logger.info('Triggering new Category Facet search');\n      const categoryFacetValues = await this.categoryFacet.categoryFacetQueryController.searchFacetValues(\n        this.facetSearchElement.input.value,\n        this.numberOfValuesToFetch\n      );\n      this.logAnalyticsEvent();\n      if (categoryFacetValues.length < this.numberOfValuesToFetch) {\n        this.moreValuesToFetch = false;\n      }\n      if (categoryFacetValues.length == 0) {\n        this.noFacetSearchResults();\n        return;\n      }\n      this.removeNoResultsCssClasses();\n      this.setFacetSearchResults(categoryFacetValues);\n\n      if (this.shouldPositionSearchResults) {\n        this.facetSearchElement.positionSearchResults(\n          this.categoryFacet.root,\n          this.categoryFacet.element.clientWidth,\n          this.facetSearchElement.search\n        );\n      }\n\n      this.facetSearchElement.hideFacetSearchWaitingAnimation();\n    };\n  }\n\n  private setFacetSearchResults(categoryFacetValues: IGroupByValue[]) {\n    $$(this.facetSearchElement.searchResults).empty();\n    this.currentlyDisplayedResults = pluck(categoryFacetValues, 'value');\n    for (let i = 0; i < categoryFacetValues.length; i++) {\n      const searchResult = this.buildFacetSearchValue(categoryFacetValues[i]);\n      if (i == 0) {\n        this.facetSearchElement.setAsCurrentResult(searchResult);\n      }\n      this.facetSearchElement.appendToSearchResults(searchResult.el);\n    }\n    this.highlightCurrentQueryWithinSearchResults();\n  }\n\n  private buildFacetSearchValue(categoryFacetValue: IGroupByValue) {\n    const path = categoryFacetValue.value.split(this.categoryFacet.options.delimitingCharacter);\n\n    const pathParents = path.slice(0, -1).length != 0 ? `${path.slice(0, -1).join('/')}/` : '';\n\n    const value = $$('span', { className: 'coveo-category-facet-search-value-caption' }, last(path));\n    const number = $$('span', { className: 'coveo-category-facet-search-value-number' }, categoryFacetValue.numberOfResults.toString(10));\n    const pathParentsCaption = $$('span', { className: 'coveo-category-facet-search-path-parents' }, pathParents);\n\n    const pathToValueCaption = $$('span', { className: 'coveo-category-facet-search-path' }, pathParentsCaption);\n\n    const firstRow = $$('div', { className: 'coveo-category-facet-search-first-row' }, value, number);\n    const secondRow = $$('div', { className: 'coveo-category-facet-search-second-row' }, pathToValueCaption);\n    const item = $$(\n      'li',\n      {\n        className: 'coveo-category-facet-search-value',\n        title: path\n      },\n      firstRow,\n      secondRow\n    );\n    item.el.dataset.path = categoryFacetValue.value;\n\n    new AccessibleButton()\n      .withElement(item)\n      .withSelectAction(() => {\n        this.categoryFacet.changeActivePath(path);\n        this.categoryFacet.logAnalyticsEvent(analyticsActionCauseList.categoryFacetSelect, path);\n        this.categoryFacet.executeQuery();\n      })\n      .withLabel(`${l(last(path))} ${categoryFacetValue.numberOfResults}`)\n      .build();\n\n    return item;\n  }\n\n  private noFacetSearchResults() {\n    this.facetSearchElement.hideFacetSearchWaitingAnimation();\n    this.facetSearchElement.hideSearchResultsElement();\n    $$(this.facetSearchElement.search).addClass('coveo-facet-search-no-results');\n    $$(this.categoryFacet.element).addClass('coveo-no-results');\n  }\n\n  private removeNoResultsCssClasses() {\n    this.facetSearchElement.search && $$(this.facetSearchElement.search).removeClass('coveo-facet-search-no-results');\n    $$(this.categoryFacet.element).removeClass('coveo-no-results');\n  }\n\n  private highlightCurrentQueryWithinSearchResults() {\n    const regex = new RegExp(`(${StringUtils.stringToRegex(this.facetSearchElement.input.value, true)})`, 'ig');\n    this.facetSearchElement.highlightCurrentQueryInSearchResults(regex);\n  }\n\n  private logAnalyticsEvent() {\n    this.categoryFacet.usageAnalytics.logCustomEvent<IAnalyticsCategoryFacetMeta>(\n      analyticsActionCauseList.categoryFacetSearch,\n      {\n        categoryFacetId: this.categoryFacet.options.id,\n        categoryFacetTitle: this.categoryFacet.options.title\n      },\n      this.categoryFacet.root\n    );\n  }\n\n  private get shouldPositionSearchResults() {\n    const searchResults = this.facetSearchElement.searchResults;\n    return searchResults && !searchResults.parentElement;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/CategoryFacet/CategoryFacetSearch.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_CategoryFacetSearch.scss\n// module id = 496\n// module chunks = 10 78","import { $$ } from '../../utils/Dom';\nimport { SVGDom } from '../../utils/SVGDom';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { CategoryValueDescriptor } from './CategoryFacet';\n\nexport class CategoryFacetBreadcrumb {\n  constructor(\n    private categoryFacetTitle: string,\n    private onClickHandler: (e: MouseEvent) => void,\n    private categoryValueDescriptor: CategoryValueDescriptor\n  ) {}\n\n  public build(): HTMLElement {\n    const clear = $$(\n      'span',\n      {\n        className: 'coveo-facet-breadcrumb-clear'\n      },\n      SVGIcons.icons.checkboxHookExclusionMore\n    );\n    SVGDom.addClassToSVGInContainer(clear.el, 'coveo-facet-breadcrumb-clear-svg');\n\n    const title = `${this.categoryValueDescriptor.value} ${this.categoryValueDescriptor.count}`;\n    const breadcrumbTitle = $$('span', { className: 'coveo-category-facet-breadcrumb-title' }, `${this.categoryFacetTitle}: `);\n    const values = $$('span', { className: 'coveo-category-facet-breadcrumb-values' }, this.categoryValueDescriptor.path.join('/'), clear);\n    const breadcrumb = $$('span', { className: 'coveo-category-facet-breadcrumb', title }, breadcrumbTitle, values);\n    breadcrumb.on('click', this.onClickHandler);\n    return breadcrumb.el;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/CategoryFacet/CategoryFacetBreadcrumb.ts","import { CategoryFacet } from './CategoryFacet';\nimport { IBuildingQueryEventArgs, QueryEvents, IQuerySuccessEventArgs } from '../../events/QueryEvents';\nimport { IGroupByResult } from '../../rest/GroupByResult';\nimport { QueryBuilder } from '../Base/QueryBuilder';\nimport { sortBy, chain } from 'underscore';\nimport { Logger } from '../../misc/Logger';\nimport { IGroupByValue } from '../../rest/GroupByValue';\n\nclass PathMap {\n  get: (key: string) => PathMap;\n  set: (key: string, value?: PathMap) => void;\n}\n\ntype DebugGroupByPositionInQuery = {\n  start: number;\n  end: number;\n};\n\nexport class CategoryFacetDebug {\n  private static logger = new Logger(CategoryFacet);\n  private positionInQuery: DebugGroupByPositionInQuery;\n  constructor(private categoryFacet: CategoryFacet) {\n    this.categoryFacet.bind.onRootElement<IBuildingQueryEventArgs>(QueryEvents.buildingQuery, args => this.handleBuildingQuery(args));\n    this.categoryFacet.bind.onRootElement<IQuerySuccessEventArgs>(QueryEvents.querySuccess, args => {\n      this.handleQuerySuccess(args);\n    });\n  }\n\n  private handleBuildingQuery(args: IBuildingQueryEventArgs) {\n    const firstPositionInQuery = args.queryBuilder.groupByRequests.length;\n    if (this.categoryFacet.activePath.length == 0) {\n      this.positionInQuery = { start: firstPositionInQuery, end: firstPositionInQuery + 1 };\n      this.addGroupByForEmptyPath(args.queryBuilder);\n    } else {\n      const path = this.categoryFacet.activePath;\n      this.positionInQuery = { start: firstPositionInQuery, end: firstPositionInQuery + path.length };\n      this.addGroupByForEachPathElement(args.queryBuilder, path);\n    }\n  }\n\n  private handleQuerySuccess(args: IQuerySuccessEventArgs) {\n    args.results.groupByResults\n      .slice(this.positionInQuery.start, this.positionInQuery.end)\n      .forEach(groupByResult => CategoryFacetDebug.analyzeResults(groupByResult, this.categoryFacet.options.delimitingCharacter));\n  }\n\n  private addGroupByForEmptyPath(queryBuilder: QueryBuilder) {\n    queryBuilder.groupByRequests.push({\n      field: this.categoryFacet.options.field as string,\n      injectionDepth: this.categoryFacet.options.injectionDepth\n    });\n  }\n\n  private addGroupByForEachPathElement(queryBuilder: QueryBuilder, path: string[]) {\n    path.forEach(pathElement => {\n      this.categoryFacet.categoryFacetQueryController.addDebugGroupBy(queryBuilder, pathElement);\n    });\n  }\n\n  public static analyzeResults(groupByResults: IGroupByResult, delimiter: string) {\n    const treeRoot: PathMap = new Map<string, PathMap>();\n    const orphans: string[] = [];\n\n    let paths = this.buildPathsFromGroupByValues(groupByResults.values, delimiter);\n    paths = sortBy(paths, value => value.length);\n\n    paths.forEach(path => {\n      if (path.length == 1) {\n        this.addFirstNodeToTree(treeRoot, path);\n      } else {\n        let pathIsValid = true;\n        const parentsOnly = path.slice(0, -1);\n        let currentNode = treeRoot;\n        for (const parent of parentsOnly) {\n          currentNode = currentNode.get(parent);\n          if (!currentNode) {\n            this.processOrphan(orphans, path, delimiter);\n            pathIsValid = false;\n            break;\n          }\n        }\n        if (pathIsValid) {\n          this.addValidNodeToTree(currentNode, path);\n        }\n      }\n    });\n    return orphans;\n  }\n\n  private static buildPathsFromGroupByValues(values: IGroupByValue[], delimiter: string) {\n    return chain(values)\n      .pluck('value')\n      .map((value: string) => value.split(delimiter))\n      .sortBy(value => value.length)\n      .value();\n  }\n\n  private static addFirstNodeToTree(treeRoot: PathMap, path: string[]) {\n    treeRoot.set(path[0], new Map<string, PathMap>());\n  }\n\n  private static addValidNodeToTree(node: PathMap, path: string[]) {\n    node.set(path.slice(-1)[0], new Map<string, PathMap>());\n  }\n\n  private static processOrphan(orphans: string[], path: string[], delimiter: string) {\n    const formattedOrphan = path.join(delimiter);\n    orphans.push(formattedOrphan);\n    this.logger.error(`Value ${formattedOrphan} has no parent.`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/CategoryFacet/CategoryFacetDebug.ts"],"sourceRoot":""}